!function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,a){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=7)}([function(e,t,n){"use strict";function a(e,t){if(1===arguments.length){for(var n=e[0],r=1;r<e.length;r++)n=a(n,e[r]);return n}for(var s in t)if("class"===s){var i=e[s]||[];e[s]=(Array.isArray(i)?i:[i]).concat(t[s]||[])}else if("style"===s){var i=u(e[s]),o=u(t[s]);e[s]=i+o}else e[s]=t[s];return e}function r(e,t){for(var n,a="",r="",s=Array.isArray(t),u=0;u<e.length;u++)(n=i(e[u]))&&(s&&t[u]&&(n=c(n)),a=a+r+n,r=" ");return a}function s(e){var t="",n="";for(var a in e)a&&e[a]&&d.call(e,a)&&(t=t+n+a,n=" ");return t}function i(e,t){return Array.isArray(e)?r(e,t):e&&"object"==typeof e?s(e):e||""}function u(e){if(!e)return"";if("object"==typeof e){var t="";for(var n in e)d.call(e,n)&&(t=t+n+":"+e[n]+";");return t}return e+="",";"!==e[e.length-1]?e+";":e}function o(e,t,n,a){return!1!==t&&null!=t&&(t||"class"!==e&&"style"!==e)?!0===t?" "+(a?e:e+'="'+e+'"'):("function"==typeof t.toJSON&&(t=t.toJSON()),"string"==typeof t||(t=JSON.stringify(t),n||-1===t.indexOf('"'))?(n&&(t=c(t))," "+e+'="'+t+'"'):" "+e+"='"+t.replace(/'/g,"&#39;")+"'"):""}function l(e,t){var n="";for(var a in e)if(d.call(e,a)){var r=e[a];if("class"===a){r=i(r),n=o(a,r,!1,t)+n;continue}"style"===a&&(r=u(r)),n+=o(a,r,!1,t)}return n}function c(e){var t=""+e,n=v.exec(t);if(!n)return e;var a,r,s,i="";for(a=n.index,r=0;a<t.length;a++){switch(t.charCodeAt(a)){case 34:s="&quot;";break;case 38:s="&amp;";break;case 60:s="&lt;";break;case 62:s="&gt;";break;default:continue}r!==a&&(i+=t.substring(r,a)),r=a+1,i+=s}return r!==a?i+t.substring(r,a):i}function f(e,t,a,r){if(!(e instanceof Error))throw e;if(!("undefined"==typeof window&&t||r))throw e.message+=" on line "+a,e;try{r=r||n(14).readFileSync(t,"utf8")}catch(t){f(e,null,a)}var s=3,i=r.split("\n"),u=Math.max(a-s,0),o=Math.min(i.length,a+s),s=i.slice(u,o).map(function(e,t){var n=t+u+1;return(n==a?"  > ":"    ")+n+"| "+e}).join("\n");throw e.path=t,e.message=(t||"Pug")+":"+a+"\n"+s+"\n\n"+e.message,e}var d=Object.prototype.hasOwnProperty;t.merge=a,t.classes=i,t.style=u,t.attr=o,t.attrs=l;var v=/["&<>]/;t.escape=c,t.rethrow=f},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(8),u=(a(i),n(11)),o=a(u),l=function(){function e(t){var n=t.el,a=t.currentUser;r(this,e),this.el=n,this.currentUser=a,this.containerEl=document.createElement("ul"),this.containerEl.className="chat__messages",this.el.appendChild(this.containerEl),this.processedMessages={},this.initEvents()}return s(e,[{key:"on",value:function(e,t){this.el.addEventListener(e,t)}},{key:"updateMessages",value:function(e){var t=this,n=Object.keys(e),a=void 0;n.forEach(function(n){t.processedMessages[n]?a=n:t.insertMessage(n,e[n],a)}),this.scrollToBottom()}},{key:"deleteMessage",value:function(e){if(this.processedMessages[e]){var t=document.getElementById(e);t&&(this.containerEl.removeChild(t),delete this.processedMessages[e])}}},{key:"insertMessage",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(this.processedMessages[e]=!0,n&&this.processedMessages[n]){var a=document.getElementById(n);if(a)return a.insertAdjacentHTML("afterEnd",this.renderItem(e,t)),void(this.processedMessages[n]=!0)}this.containerEl.insertAdjacentHTML("beforeEnd",this.renderItem(e,t))}},{key:"initEvents",value:function(){this.el.addEventListener("click",this.click.bind(this))}},{key:"click",value:function(e){if(e.preventDefault(),"button"===e.target.type){var t=e.target.closest("li.chat__message");if(t&&t.id){var n=new CustomEvent("messageDelete",{detail:{messageId:t.id}});this.el.dispatchEvent(n)}}}},{key:"scrollToBottom",value:function(){this.el.scrollTop=this.el.scrollHeight}},{key:"renderItem",value:function(e,t){return(0,o.default)({id:e,isOwn:this.currentUser.userId===t.userId,username:t.username||this.currentUser.defaultUsername,avatarUrl:t.avatarUrl||this.currentUser.defaultAvatarUrl,date:new Date(t.date),text:t.message})}}]),e}();t.default=l},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(9),u=(a(i),n(12)),o=a(u),l=function(){function e(t){var n=t.el;r(this,e),this.el=n,this.initEvents()}return s(e,[{key:"initEvents",value:function(){this.el.addEventListener("submit",this.messageSubmit.bind(this)),this.el.addEventListener("keydown",this.keyDown.bind(this))}},{key:"on",value:function(e,t){this.el.addEventListener(e,t)}},{key:"getMessage",value:function(){this.inputEl||(this.inputEl=this.el.querySelector('[name="message"]'));var e=this.inputEl.value;return this.inputEl.value="",e}},{key:"messageSubmit",value:function(e){e.preventDefault();var t=this.getMessage();if(t){var n=new CustomEvent("messageSubmit",{detail:{message:t}});this.el.dispatchEvent(n)}}},{key:"keyDown",value:function(e){13!==e.which||e.altKey||e.ctrlKey||e.shiftKey||e.metaKey||(e.preventDefault(),this.messageSubmit(e))}},{key:"render",value:function(){this.el.innerHTML=(0,o.default)()}}]),e}();t.default=l},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(10),u=(a(i),n(13)),o=a(u),l=function(){function e(t){var n=t.el,a=t.Storage;r(this,e),this.el=n,this.storage=new a,this.initEvents(),this.data={userId:this.storage.getItem("userId")||"anonimous-"+(1e9*Math.random()).toFixed(),username:this.storage.getItem("username"),avatarUrl:this.storage.getItem("avatarUrl")},this.saveUserToStorage()}return s(e,[{key:"initEvents",value:function(){this.el.addEventListener("click",this.click.bind(this)),this.el.addEventListener("submit",this.submit.bind(this))}},{key:"saveUserToStorage",value:function(){this.storage.setItem("userId",this.data.userId),this.data.username?this.storage.setItem("username",this.data.username):this.storage.removeItem("username"),this.data.avatarUrl?this.storage.setItem("avatarUrl",this.data.avatarUrl):this.storage.removeItem("avatarUrl")}},{key:"submit",value:function(e){e.preventDefault(),e.target.classList.contains("user-form")&&e.target.dataset.action&&this[e.target.dataset.action]&&this[e.target.dataset.action](e)}},{key:"click",value:function(e){e.target.classList.contains("toggle")&&e.target.dataset.toggle&&(e.preventDefault(),this.el.querySelector("[name=username]").value=this.username,this.el.querySelector("[name=avatarUrl]").value=this.data.avatarUrl||"",this.el.querySelector(".user .user-form__"+e.target.dataset.toggle).classList.toggle("hidden"),e.target.classList.contains("toggled")&&(e.target.hidden=!0))}},{key:"setAvatar",value:function(e){var t=e.target.querySelector("[name=avatarUrl]");t&&t.value&&(this.data.avatarUrl=t.value),this.saveUserToStorage(),this.render()}},{key:"setUsername",value:function(e){var t=e.target.querySelector("[name=username]");t&&t.value&&(this.data.username=t.value,this.userId=t.value),this.saveUserToStorage(),this.render()}},{key:"render",value:function(){this.el.innerHTML=(0,o.default)(this)}},{key:"userId",get:function(){return this.data.userId},set:function(e){e&&(this.data.userId=e.toLowerCase())}},{key:"username",get:function(){return this.data.username||"Аноним"}},{key:"defaultUsername",get:function(){return"Аноним"}},{key:"avatarUrl",get:function(){return this.data.avatarUrl||"./components/user/noAvatar.jpg"}},{key:"defaultAvatarUrl",get:function(){return"./components/user/noAvatar.jpg"}}]),e}();t.default=l},function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),s=function(){function e(t){a(this,e),this.serverUrl=t}return r(e,[{key:"sendRequest",value:function(e){var t=e.type,n=void 0===t?"GET":t,a=e.path,r=e.data,s=void 0===r?{}:r,i=new XMLHttpRequest;return i.open(n,this.serverUrl+"/"+a,!0),new Promise(function(e,t){i.addEventListener("load",function(){e(JSON.parse(i.responseText))}),i.addEventListener("error",function(e){var n=new Error(e.target.statusText);n.code=e.target.status,t(n)}),i.send(JSON.stringify(s))})}},{key:"getAllMessages",value:function(){return this.sendRequest({path:"messages.json"})}},{key:"getMessage",value:function(e){return this.sendRequest({path:"messages/"+e+".json"})}},{key:"messageUpdate",value:function(e,t){return this.sendRequest({type:"PUT",path:"messages/"+e+".json",data:t})}},{key:"messageAdd",value:function(e){return this.sendRequest({type:"POST",path:"messages.json",data:e})}},{key:"messageDelete",value:function(e){return this.sendRequest({type:"DELETE",path:"messages/"+e+".json"})}}]),e}();t.default=s},function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),s=function(){function e(){a(this,e),this.storage=window.localStorage}return r(e,[{key:"getItem",value:function(e){return this.storage.getItem(e)}},{key:"setItem",value:function(e,t){return this.storage.setItem(e,t)}},{key:"removeItem",value:function(e){return this.storage.removeItem(e)}},{key:"clear",value:function(){return this.storage.clear()}}]),e}();t.default=s},function(e,t){},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(6),u=(a(i),n(5)),o=a(u),l=n(4),c=a(l),f=n(1),d=a(f),v=n(3),h=a(v),g=n(2),m=a(g),p=new c.default("https://mevlchat.firebaseio.com"),y=function(){function e(t){var n=t.userEl,a=t.messageFormEl,s=t.chatEl;r(this,e),this.user=new h.default({el:n,Storage:o.default}),this.chat=new d.default({el:s,currentUser:this.user}),this.messageForm=new m.default({el:a}),this.initEvents()}return s(e,[{key:"initEvents",value:function(){var e=this;this.messageForm.on("messageSubmit",this.messageSubmit.bind(this)),this.chat.on("messageDelete",this.deleteMessage.bind(this)),document.addEventListener("visibilitychange",function(){"hidden"===document.visibilityState?e.stopIntervalUpdate():e.startIntervalUpdate()})}},{key:"startIntervalUpdate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3e3;this.intervalUpdate(e)}},{key:"stopIntervalUpdate",value:function(){clearTimeout(this.timerId)}},{key:"intervalUpdate",value:function(e){var t=this;this.updateMessages(),this.timerId=setTimeout(function(){t.intervalUpdate.call(t,e)},e)}},{key:"updateMessages",value:function(){var e=this;p.getAllMessages().then(function(t){e.chat.updateMessages(t)}).catch(function(e){console.log("Error",e)})}},{key:"messageSubmit",value:function(e){var t=this,n={userId:this.user.userId,username:this.user.data.username,avatarUrl:this.user.data.avatarUrl,date:(new Date).getTime(),message:e.detail.message};p.messageAdd(n).then(function(){t.updateMessages()}).catch(function(e){console.log("Error",e)})}},{key:"deleteMessage",value:function(e){var t=this,n=e.detail.messageId;p.messageDelete(n).then(function(){t.chat.deleteMessage(n)}).catch(function(e){console.log("Error",e)})}},{key:"render",value:function(){this.user.render(),this.messageForm.render(),this.startIntervalUpdate()}}]),e}();window.App=y},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){function a(e){var t,n="",a=e||{};return function(e,a,s,i,u,o){n=n+"<li"+(r.attr("class",r.classes(["chat__message",i?"chat__message_own":""],[!1,!0]),!1,!0)+r.attr("id",s,!0,!0))+'><div class="chat__message_avatar"><img'+(r.attr("src",e,!0,!0)+r.attr("alt",o,!0,!0))+'></div><div class="chat__message_header"><span class="chat__message_author">'+r.escape(null==(t=o)?"":t)+'</span><input class="chat__message_button" type="button" value="x"><span class="chat__message_date">'+r.escape(null==(t=a.toLocaleString("ru",{hour:"2-digit",minute:"2-digit"}))?"":t)+'</span></div><div class="chat__message_text">'+r.escape(null==(t=u)?"":t)+"</div></li>"}.call(this,"avatarUrl"in a?a.avatarUrl:"undefined"!=typeof avatarUrl?avatarUrl:void 0,"date"in a?a.date:"undefined"!=typeof date?date:void 0,"id"in a?a.id:"undefined"!=typeof id?id:void 0,"isOwn"in a?a.isOwn:"undefined"!=typeof isOwn?isOwn:void 0,"text"in a?a.text:"undefined"!=typeof text?text:void 0,"username"in a?a.username:"undefined"!=typeof username?username:void 0),n}var r=n(0);e.exports=a},function(e,t,n){function a(e){var t="";return t+='<form class="message-form"><textarea class="message-form__input" name="message" placeholder="Сообщение..."></textarea><input class="button message-form__button input_button" type="submit" value="&gt;"></form>'}n(0);e.exports=a},function(e,t,n){function a(e){var t,n="",a=e||{};return function(e,a){n=n+'<div class="user"><h1 class="user__username toggle toggled" data-toggle="username">'+r.escape(null==(t=a)?"":t)+'</h1><form class="user-form user-form__username hidden" data-action="setUsername"><input class="user__input user__input_username" name="username" placeholder="Укажите имя"><input class="button user__input_button input_button" type="submit" value="&gt;"></form><form class="user-form user-form__avatar hidden" data-action="setAvatar"><input class="user__input user__input_avatar" name="avatarUrl" placeholder="URL аватары"><input class="button user__input_button input_button" type="submit" value="&gt;"></form><figure class="user__avatar"><img class="toggle" data-toggle="avatar"'+r.attr("src",e,!0,!0)+r.attr("alt",a,!0,!0)+"></figure></div>"}.call(this,"avatarUrl"in a?a.avatarUrl:"undefined"!=typeof avatarUrl?avatarUrl:void 0,"username"in a?a.username:"undefined"!=typeof username?username:void 0),n}var r=n(0);e.exports=a},function(e,t){}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vYXNzZXRzL2J1bmRsZS5qcyIsIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgMmRkZDM4NmZkZjM3NjZlZTYxNWMiLCJ3ZWJwYWNrOi8vLy4vfi9wdWctcnVudGltZS9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9jb21wb25lbnRzL2NoYXQvY2hhdC5qcyIsIndlYnBhY2s6Ly8vLi9jb21wb25lbnRzL21lc3NhZ2VGb3JtL21lc3NhZ2VGb3JtLmpzIiwid2VicGFjazovLy8uL2NvbXBvbmVudHMvdXNlci91c2VyLmpzIiwid2VicGFjazovLy8uL21vZHVsZXMvaHR0cFJlcXVlc3QuanMiLCJ3ZWJwYWNrOi8vLy4vbW9kdWxlcy9zdG9yYWdlLmpzIiwid2VicGFjazovLy8uL2NvbXBvbmVudHMvYXBwL2FwcC5qcyIsIndlYnBhY2s6Ly8vLi9jb21wb25lbnRzL2NoYXQvbWVzc2FnZS50bXBsLnB1ZyIsIndlYnBhY2s6Ly8vLi9jb21wb25lbnRzL21lc3NhZ2VGb3JtL2Zvcm0udG1wbC5wdWciLCJ3ZWJwYWNrOi8vLy4vY29tcG9uZW50cy91c2VyL3VzZXIudG1wbC5wdWciXSwibmFtZXMiOlsibW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImluc3RhbGxlZE1vZHVsZXMiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJjYWxsIiwibSIsImMiLCJ2YWx1ZSIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiY29uZmlndXJhYmxlIiwiZW51bWVyYWJsZSIsImdldCIsIm4iLCJfX2VzTW9kdWxlIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwicHVnX21lcmdlIiwiYSIsImIiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJhdHRycyIsImtleSIsInZhbEEiLCJBcnJheSIsImlzQXJyYXkiLCJjb25jYXQiLCJwdWdfc3R5bGUiLCJ2YWxCIiwicHVnX2NsYXNzZXNfYXJyYXkiLCJ2YWwiLCJlc2NhcGluZyIsImNsYXNzTmFtZSIsImNsYXNzU3RyaW5nIiwicGFkZGluZyIsImVzY2FwZUVuYWJsZWQiLCJwdWdfY2xhc3NlcyIsInB1Z19lc2NhcGUiLCJwdWdfY2xhc3Nlc19vYmplY3QiLCJwdWdfaGFzX293bl9wcm9wZXJ0eSIsIm91dCIsInN0eWxlIiwicHVnX2F0dHIiLCJlc2NhcGVkIiwidGVyc2UiLCJ0b0pTT04iLCJKU09OIiwic3RyaW5naWZ5IiwiaW5kZXhPZiIsInJlcGxhY2UiLCJwdWdfYXR0cnMiLCJvYmoiLCJfaHRtbCIsImh0bWwiLCJyZWdleFJlc3VsdCIsInB1Z19tYXRjaF9odG1sIiwiZXhlYyIsImxhc3RJbmRleCIsImVzY2FwZSIsInJlc3VsdCIsImluZGV4IiwiY2hhckNvZGVBdCIsInN1YnN0cmluZyIsInB1Z19yZXRocm93IiwiZXJyIiwiZmlsZW5hbWUiLCJsaW5lbm8iLCJzdHIiLCJFcnJvciIsIndpbmRvdyIsIm1lc3NhZ2UiLCJyZWFkRmlsZVN5bmMiLCJleCIsImNvbnRleHQiLCJsaW5lcyIsInNwbGl0Iiwic3RhcnQiLCJNYXRoIiwibWF4IiwiZW5kIiwibWluIiwic2xpY2UiLCJtYXAiLCJsaW5lIiwiY3VyciIsImpvaW4iLCJwYXRoIiwibWVyZ2UiLCJjbGFzc2VzIiwiYXR0ciIsInJldGhyb3ciLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwiZGVmYXVsdCIsIl9jbGFzc0NhbGxDaGVjayIsImluc3RhbmNlIiwiQ29uc3RydWN0b3IiLCJUeXBlRXJyb3IiLCJfY3JlYXRlQ2xhc3MiLCJkZWZpbmVQcm9wZXJ0aWVzIiwidGFyZ2V0IiwicHJvcHMiLCJkZXNjcmlwdG9yIiwid3JpdGFibGUiLCJwcm90b1Byb3BzIiwic3RhdGljUHJvcHMiLCJfY2hhdCIsIl9tZXNzYWdlVG1wbCIsIl9tZXNzYWdlVG1wbDIiLCJDaGF0IiwiX3JlZiIsImVsIiwiY3VycmVudFVzZXIiLCJ0aGlzIiwiY29udGFpbmVyRWwiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJhcHBlbmRDaGlsZCIsInByb2Nlc3NlZE1lc3NhZ2VzIiwiaW5pdEV2ZW50cyIsImV2ZW50IiwiaGFuZGxlciIsImFkZEV2ZW50TGlzdGVuZXIiLCJtZXNzYWdlcyIsIl90aGlzIiwiaWRzIiwia2V5cyIsImxhc3RFeGlzdE1lc3NhZ2VJZCIsImZvckVhY2giLCJtZXNzYWdlSWQiLCJpbnNlcnRNZXNzYWdlIiwic2Nyb2xsVG9Cb3R0b20iLCJnZXRFbGVtZW50QnlJZCIsInJlbW92ZUNoaWxkIiwiYWZ0ZXJNZXNzYWdlSWQiLCJ1bmRlZmluZWQiLCJhZnRlckVsIiwiaW5zZXJ0QWRqYWNlbnRIVE1MIiwicmVuZGVySXRlbSIsImNsaWNrIiwiYmluZCIsInByZXZlbnREZWZhdWx0IiwidHlwZSIsIm1lc3NhZ2VJdGVtIiwiY2xvc2VzdCIsImlkIiwiZGVsZXRlRXZlbnQiLCJDdXN0b21FdmVudCIsImRldGFpbCIsImRpc3BhdGNoRXZlbnQiLCJzY3JvbGxUb3AiLCJzY3JvbGxIZWlnaHQiLCJpc093biIsInVzZXJJZCIsInVzZXJuYW1lIiwiZGVmYXVsdFVzZXJuYW1lIiwiYXZhdGFyVXJsIiwiZGVmYXVsdEF2YXRhclVybCIsImRhdGUiLCJEYXRlIiwidGV4dCIsIl9tZXNzYWdlRm9ybSIsIl9mb3JtVG1wbCIsIl9mb3JtVG1wbDIiLCJNZXNzYWdlRm9ybSIsIm1lc3NhZ2VTdWJtaXQiLCJrZXlEb3duIiwiaW5wdXRFbCIsInF1ZXJ5U2VsZWN0b3IiLCJnZXRNZXNzYWdlIiwib25TdWJtaXRFdmVudCIsIndoaWNoIiwiYWx0S2V5IiwiY3RybEtleSIsInNoaWZ0S2V5IiwibWV0YUtleSIsImlubmVySFRNTCIsIl91c2VyIiwiX3VzZXJUbXBsIiwiX3VzZXJUbXBsMiIsIlVzZXIiLCJTdG9yYWdlIiwic3RvcmFnZSIsImRhdGEiLCJnZXRJdGVtIiwicmFuZG9tIiwidG9GaXhlZCIsInNhdmVVc2VyVG9TdG9yYWdlIiwic3VibWl0Iiwic2V0SXRlbSIsInJlbW92ZUl0ZW0iLCJjbGFzc0xpc3QiLCJjb250YWlucyIsImRhdGFzZXQiLCJhY3Rpb24iLCJ0b2dnbGUiLCJoaWRkZW4iLCJyZW5kZXIiLCJzZXQiLCJ0b0xvd2VyQ2FzZSIsIkh0dHBSZXF1ZXN0Iiwic2VydmVyVXJsIiwiX3JlZiR0eXBlIiwiX3JlZiRkYXRhIiwicmVxdWVzdCIsIlhNTEh0dHBSZXF1ZXN0Iiwib3BlbiIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwicGFyc2UiLCJyZXNwb25zZVRleHQiLCJlcnJvciIsInN0YXR1c1RleHQiLCJjb2RlIiwic3RhdHVzIiwic2VuZCIsInNlbmRSZXF1ZXN0IiwibG9jYWxTdG9yYWdlIiwiY2xlYXIiLCJfYXBwIiwiX3N0b3JhZ2UiLCJfc3RvcmFnZTIiLCJfaHR0cFJlcXVlc3QiLCJfaHR0cFJlcXVlc3QyIiwiX2NoYXQyIiwiX3VzZXIyIiwiX21lc3NhZ2VGb3JtMiIsInNlcnZlclJlcXVlc3QiLCJBcHAiLCJ1c2VyRWwiLCJtZXNzYWdlRm9ybUVsIiwiY2hhdEVsIiwidXNlciIsImNoYXQiLCJtZXNzYWdlRm9ybSIsIm9uIiwiZGVsZXRlTWVzc2FnZSIsInZpc2liaWxpdHlTdGF0ZSIsInN0b3BJbnRlcnZhbFVwZGF0ZSIsInN0YXJ0SW50ZXJ2YWxVcGRhdGUiLCJpbnRlcnZhbCIsImludGVydmFsVXBkYXRlIiwiY2xlYXJUaW1lb3V0IiwidGltZXJJZCIsIl90aGlzMiIsInVwZGF0ZU1lc3NhZ2VzIiwic2V0VGltZW91dCIsIl90aGlzMyIsImdldEFsbE1lc3NhZ2VzIiwidGhlbiIsInJlc3BvbnNlIiwiY2F0Y2giLCJjb25zb2xlIiwibG9nIiwiX3RoaXM0IiwiZ2V0VGltZSIsIm1lc3NhZ2VBZGQiLCJfdGhpczUiLCJtZXNzYWdlRGVsZXRlIiwidGVtcGxhdGUiLCJsb2NhbHMiLCJwdWdfaW50ZXJwIiwicHVnX2h0bWwiLCJsb2NhbHNfZm9yX3dpdGgiLCJwdWciLCJ0b0xvY2FsZVN0cmluZyIsImhv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QUEsYUFBQXVKLEtBQUE1RyxVQUFBLG1CQUFBQSx5QkFBQXJCLEdBQUEsWUFBQWlJLEtBQUE5RyxTQUFBLG1CQUFBQSx1QkFBQW5CLElBQWtPZ0ksRUFGajdDLEdBQUFFLEdBQUFwUixFQUFBLEVBR0FJLEdBQUFELFFBQUE0USxHWHF4Q00sU0FBVTNRLEVBQVFEIiwiZmlsZSI6Ii4vYXNzZXRzL2J1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXBcbi8qKioqKiovIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbi8qKioqKiovIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbi8qKioqKiovIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuLyoqKioqKi8gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4vKioqKioqLyBcdFx0fVxuLyoqKioqKi8gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4vKioqKioqLyBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuLyoqKioqKi8gXHRcdFx0aTogbW9kdWxlSWQsXG4vKioqKioqLyBcdFx0XHRsOiBmYWxzZSxcbi8qKioqKiovIFx0XHRcdGV4cG9ydHM6IHt9XG4vKioqKioqLyBcdFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4vKioqKioqLyBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbi8qKioqKiovIFx0XHRtb2R1bGUubCA9IHRydWU7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4vKioqKioqLyBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuLyoqKioqKi8gXHR9XG4vKioqKioqL1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBpZGVudGl0eSBmdW5jdGlvbiBmb3IgY2FsbGluZyBoYXJtb255IGltcG9ydHMgd2l0aCB0aGUgY29ycmVjdCBjb250ZXh0XG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uaSA9IGZ1bmN0aW9uKHZhbHVlKSB7IHJldHVybiB2YWx1ZTsgfTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbi8qKioqKiovIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4vKioqKioqLyBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuLyoqKioqKi8gXHRcdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuLyoqKioqKi8gXHRcdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuLyoqKioqKi8gXHRcdFx0XHRnZXQ6IGdldHRlclxuLyoqKioqKi8gXHRcdFx0fSk7XG4vKioqKioqLyBcdFx0fVxuLyoqKioqKi8gXHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4vKioqKioqLyBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4vKioqKioqLyBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuLyoqKioqKi8gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbi8qKioqKiovIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4vKioqKioqLyBcdFx0cmV0dXJuIGdldHRlcjtcbi8qKioqKiovIFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vKioqKioqLyBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDcpO1xuLyoqKioqKi8gfSlcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vKioqKioqLyAoW1xuLyogMCAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcblxuXG52YXIgcHVnX2hhc19vd25fcHJvcGVydHkgPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5O1xuXG4vKipcbiAqIE1lcmdlIHR3byBhdHRyaWJ1dGUgb2JqZWN0cyBnaXZpbmcgcHJlY2VkZW5jZVxuICogdG8gdmFsdWVzIGluIG9iamVjdCBgYmAuIENsYXNzZXMgYXJlIHNwZWNpYWwtY2FzZWRcbiAqIGFsbG93aW5nIGZvciBhcnJheXMgYW5kIG1lcmdpbmcvam9pbmluZyBhcHByb3ByaWF0ZWx5XG4gKiByZXN1bHRpbmcgaW4gYSBzdHJpbmcuXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IGFcbiAqIEBwYXJhbSB7T2JqZWN0fSBiXG4gKiBAcmV0dXJuIHtPYmplY3R9IGFcbiAqIEBhcGkgcHJpdmF0ZVxuICovXG5cbmV4cG9ydHMubWVyZ2UgPSBwdWdfbWVyZ2U7XG5mdW5jdGlvbiBwdWdfbWVyZ2UoYSwgYikge1xuICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSkge1xuICAgIHZhciBhdHRycyA9IGFbMF07XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhLmxlbmd0aDsgaSsrKSB7XG4gICAgICBhdHRycyA9IHB1Z19tZXJnZShhdHRycywgYVtpXSk7XG4gICAgfVxuICAgIHJldHVybiBhdHRycztcbiAgfVxuXG4gIGZvciAodmFyIGtleSBpbiBiKSB7XG4gICAgaWYgKGtleSA9PT0gJ2NsYXNzJykge1xuICAgICAgdmFyIHZhbEEgPSBhW2tleV0gfHwgW107XG4gICAgICBhW2tleV0gPSAoQXJyYXkuaXNBcnJheSh2YWxBKSA/IHZhbEEgOiBbdmFsQV0pLmNvbmNhdChiW2tleV0gfHwgW10pO1xuICAgIH0gZWxzZSBpZiAoa2V5ID09PSAnc3R5bGUnKSB7XG4gICAgICB2YXIgdmFsQSA9IHB1Z19zdHlsZShhW2tleV0pO1xuICAgICAgdmFyIHZhbEIgPSBwdWdfc3R5bGUoYltrZXldKTtcbiAgICAgIGFba2V5XSA9IHZhbEEgKyB2YWxCO1xuICAgIH0gZWxzZSB7XG4gICAgICBhW2tleV0gPSBiW2tleV07XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGE7XG59O1xuXG4vKipcbiAqIFByb2Nlc3MgYXJyYXksIG9iamVjdCwgb3Igc3RyaW5nIGFzIGEgc3RyaW5nIG9mIGNsYXNzZXMgZGVsaW1pdGVkIGJ5IGEgc3BhY2UuXG4gKlxuICogSWYgYHZhbGAgaXMgYW4gYXJyYXksIGFsbCBtZW1iZXJzIG9mIGl0IGFuZCBpdHMgc3ViYXJyYXlzIGFyZSBjb3VudGVkIGFzXG4gKiBjbGFzc2VzLiBJZiBgZXNjYXBpbmdgIGlzIGFuIGFycmF5LCB0aGVuIHdoZXRoZXIgb3Igbm90IHRoZSBpdGVtIGluIGB2YWxgIGlzXG4gKiBlc2NhcGVkIGRlcGVuZHMgb24gdGhlIGNvcnJlc3BvbmRpbmcgaXRlbSBpbiBgZXNjYXBpbmdgLiBJZiBgZXNjYXBpbmdgIGlzXG4gKiBub3QgYW4gYXJyYXksIG5vIGVzY2FwaW5nIGlzIGRvbmUuXG4gKlxuICogSWYgYHZhbGAgaXMgYW4gb2JqZWN0LCBhbGwgdGhlIGtleXMgd2hvc2UgdmFsdWUgaXMgdHJ1dGh5IGFyZSBjb3VudGVkIGFzXG4gKiBjbGFzc2VzLiBObyBlc2NhcGluZyBpcyBkb25lLlxuICpcbiAqIElmIGB2YWxgIGlzIGEgc3RyaW5nLCBpdCBpcyBjb3VudGVkIGFzIGEgY2xhc3MuIE5vIGVzY2FwaW5nIGlzIGRvbmUuXG4gKlxuICogQHBhcmFtIHsoQXJyYXkuPHN0cmluZz58T2JqZWN0LjxzdHJpbmcsIGJvb2xlYW4+fHN0cmluZyl9IHZhbFxuICogQHBhcmFtIHs/QXJyYXkuPHN0cmluZz59IGVzY2FwaW5nXG4gKiBAcmV0dXJuIHtTdHJpbmd9XG4gKi9cbmV4cG9ydHMuY2xhc3NlcyA9IHB1Z19jbGFzc2VzO1xuZnVuY3Rpb24gcHVnX2NsYXNzZXNfYXJyYXkodmFsLCBlc2NhcGluZykge1xuICB2YXIgY2xhc3NTdHJpbmcgPSAnJywgY2xhc3NOYW1lLCBwYWRkaW5nID0gJycsIGVzY2FwZUVuYWJsZWQgPSBBcnJheS5pc0FycmF5KGVzY2FwaW5nKTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCB2YWwubGVuZ3RoOyBpKyspIHtcbiAgICBjbGFzc05hbWUgPSBwdWdfY2xhc3Nlcyh2YWxbaV0pO1xuICAgIGlmICghY2xhc3NOYW1lKSBjb250aW51ZTtcbiAgICBlc2NhcGVFbmFibGVkICYmIGVzY2FwaW5nW2ldICYmIChjbGFzc05hbWUgPSBwdWdfZXNjYXBlKGNsYXNzTmFtZSkpO1xuICAgIGNsYXNzU3RyaW5nID0gY2xhc3NTdHJpbmcgKyBwYWRkaW5nICsgY2xhc3NOYW1lO1xuICAgIHBhZGRpbmcgPSAnICc7XG4gIH1cbiAgcmV0dXJuIGNsYXNzU3RyaW5nO1xufVxuZnVuY3Rpb24gcHVnX2NsYXNzZXNfb2JqZWN0KHZhbCkge1xuICB2YXIgY2xhc3NTdHJpbmcgPSAnJywgcGFkZGluZyA9ICcnO1xuICBmb3IgKHZhciBrZXkgaW4gdmFsKSB7XG4gICAgaWYgKGtleSAmJiB2YWxba2V5XSAmJiBwdWdfaGFzX293bl9wcm9wZXJ0eS5jYWxsKHZhbCwga2V5KSkge1xuICAgICAgY2xhc3NTdHJpbmcgPSBjbGFzc1N0cmluZyArIHBhZGRpbmcgKyBrZXk7XG4gICAgICBwYWRkaW5nID0gJyAnO1xuICAgIH1cbiAgfVxuICByZXR1cm4gY2xhc3NTdHJpbmc7XG59XG5mdW5jdGlvbiBwdWdfY2xhc3Nlcyh2YWwsIGVzY2FwaW5nKSB7XG4gIGlmIChBcnJheS5pc0FycmF5KHZhbCkpIHtcbiAgICByZXR1cm4gcHVnX2NsYXNzZXNfYXJyYXkodmFsLCBlc2NhcGluZyk7XG4gIH0gZWxzZSBpZiAodmFsICYmIHR5cGVvZiB2YWwgPT09ICdvYmplY3QnKSB7XG4gICAgcmV0dXJuIHB1Z19jbGFzc2VzX29iamVjdCh2YWwpO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiB2YWwgfHwgJyc7XG4gIH1cbn1cblxuLyoqXG4gKiBDb252ZXJ0IG9iamVjdCBvciBzdHJpbmcgdG8gYSBzdHJpbmcgb2YgQ1NTIHN0eWxlcyBkZWxpbWl0ZWQgYnkgYSBzZW1pY29sb24uXG4gKlxuICogQHBhcmFtIHsoT2JqZWN0LjxzdHJpbmcsIHN0cmluZz58c3RyaW5nKX0gdmFsXG4gKiBAcmV0dXJuIHtTdHJpbmd9XG4gKi9cblxuZXhwb3J0cy5zdHlsZSA9IHB1Z19zdHlsZTtcbmZ1bmN0aW9uIHB1Z19zdHlsZSh2YWwpIHtcbiAgaWYgKCF2YWwpIHJldHVybiAnJztcbiAgaWYgKHR5cGVvZiB2YWwgPT09ICdvYmplY3QnKSB7XG4gICAgdmFyIG91dCA9ICcnO1xuICAgIGZvciAodmFyIHN0eWxlIGluIHZhbCkge1xuICAgICAgLyogaXN0YW5idWwgaWdub3JlIGVsc2UgKi9cbiAgICAgIGlmIChwdWdfaGFzX293bl9wcm9wZXJ0eS5jYWxsKHZhbCwgc3R5bGUpKSB7XG4gICAgICAgIG91dCA9IG91dCArIHN0eWxlICsgJzonICsgdmFsW3N0eWxlXSArICc7JztcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG91dDtcbiAgfSBlbHNlIHtcbiAgICB2YWwgKz0gJyc7XG4gICAgaWYgKHZhbFt2YWwubGVuZ3RoIC0gMV0gIT09ICc7JykgXG4gICAgICByZXR1cm4gdmFsICsgJzsnO1xuICAgIHJldHVybiB2YWw7XG4gIH1cbn07XG5cbi8qKlxuICogUmVuZGVyIHRoZSBnaXZlbiBhdHRyaWJ1dGUuXG4gKlxuICogQHBhcmFtIHtTdHJpbmd9IGtleVxuICogQHBhcmFtIHtTdHJpbmd9IHZhbFxuICogQHBhcmFtIHtCb29sZWFufSBlc2NhcGVkXG4gKiBAcGFyYW0ge0Jvb2xlYW59IHRlcnNlXG4gKiBAcmV0dXJuIHtTdHJpbmd9XG4gKi9cbmV4cG9ydHMuYXR0ciA9IHB1Z19hdHRyO1xuZnVuY3Rpb24gcHVnX2F0dHIoa2V5LCB2YWwsIGVzY2FwZWQsIHRlcnNlKSB7XG4gIGlmICh2YWwgPT09IGZhbHNlIHx8IHZhbCA9PSBudWxsIHx8ICF2YWwgJiYgKGtleSA9PT0gJ2NsYXNzJyB8fCBrZXkgPT09ICdzdHlsZScpKSB7XG4gICAgcmV0dXJuICcnO1xuICB9XG4gIGlmICh2YWwgPT09IHRydWUpIHtcbiAgICByZXR1cm4gJyAnICsgKHRlcnNlID8ga2V5IDoga2V5ICsgJz1cIicgKyBrZXkgKyAnXCInKTtcbiAgfVxuICBpZiAodHlwZW9mIHZhbC50b0pTT04gPT09ICdmdW5jdGlvbicpIHtcbiAgICB2YWwgPSB2YWwudG9KU09OKCk7XG4gIH1cbiAgaWYgKHR5cGVvZiB2YWwgIT09ICdzdHJpbmcnKSB7XG4gICAgdmFsID0gSlNPTi5zdHJpbmdpZnkodmFsKTtcbiAgICBpZiAoIWVzY2FwZWQgJiYgdmFsLmluZGV4T2YoJ1wiJykgIT09IC0xKSB7XG4gICAgICByZXR1cm4gJyAnICsga2V5ICsgJz1cXCcnICsgdmFsLnJlcGxhY2UoLycvZywgJyYjMzk7JykgKyAnXFwnJztcbiAgICB9XG4gIH1cbiAgaWYgKGVzY2FwZWQpIHZhbCA9IHB1Z19lc2NhcGUodmFsKTtcbiAgcmV0dXJuICcgJyArIGtleSArICc9XCInICsgdmFsICsgJ1wiJztcbn07XG5cbi8qKlxuICogUmVuZGVyIHRoZSBnaXZlbiBhdHRyaWJ1dGVzIG9iamVjdC5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gb2JqXG4gKiBAcGFyYW0ge09iamVjdH0gdGVyc2Ugd2hldGhlciB0byB1c2UgSFRNTDUgdGVyc2UgYm9vbGVhbiBhdHRyaWJ1dGVzXG4gKiBAcmV0dXJuIHtTdHJpbmd9XG4gKi9cbmV4cG9ydHMuYXR0cnMgPSBwdWdfYXR0cnM7XG5mdW5jdGlvbiBwdWdfYXR0cnMob2JqLCB0ZXJzZSl7XG4gIHZhciBhdHRycyA9ICcnO1xuXG4gIGZvciAodmFyIGtleSBpbiBvYmopIHtcbiAgICBpZiAocHVnX2hhc19vd25fcHJvcGVydHkuY2FsbChvYmosIGtleSkpIHtcbiAgICAgIHZhciB2YWwgPSBvYmpba2V5XTtcblxuICAgICAgaWYgKCdjbGFzcycgPT09IGtleSkge1xuICAgICAgICB2YWwgPSBwdWdfY2xhc3Nlcyh2YWwpO1xuICAgICAgICBhdHRycyA9IHB1Z19hdHRyKGtleSwgdmFsLCBmYWxzZSwgdGVyc2UpICsgYXR0cnM7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgaWYgKCdzdHlsZScgPT09IGtleSkge1xuICAgICAgICB2YWwgPSBwdWdfc3R5bGUodmFsKTtcbiAgICAgIH1cbiAgICAgIGF0dHJzICs9IHB1Z19hdHRyKGtleSwgdmFsLCBmYWxzZSwgdGVyc2UpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBhdHRycztcbn07XG5cbi8qKlxuICogRXNjYXBlIHRoZSBnaXZlbiBzdHJpbmcgb2YgYGh0bWxgLlxuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSBodG1sXG4gKiBAcmV0dXJuIHtTdHJpbmd9XG4gKiBAYXBpIHByaXZhdGVcbiAqL1xuXG52YXIgcHVnX21hdGNoX2h0bWwgPSAvW1wiJjw+XS87XG5leHBvcnRzLmVzY2FwZSA9IHB1Z19lc2NhcGU7XG5mdW5jdGlvbiBwdWdfZXNjYXBlKF9odG1sKXtcbiAgdmFyIGh0bWwgPSAnJyArIF9odG1sO1xuICB2YXIgcmVnZXhSZXN1bHQgPSBwdWdfbWF0Y2hfaHRtbC5leGVjKGh0bWwpO1xuICBpZiAoIXJlZ2V4UmVzdWx0KSByZXR1cm4gX2h0bWw7XG5cbiAgdmFyIHJlc3VsdCA9ICcnO1xuICB2YXIgaSwgbGFzdEluZGV4LCBlc2NhcGU7XG4gIGZvciAoaSA9IHJlZ2V4UmVzdWx0LmluZGV4LCBsYXN0SW5kZXggPSAwOyBpIDwgaHRtbC5sZW5ndGg7IGkrKykge1xuICAgIHN3aXRjaCAoaHRtbC5jaGFyQ29kZUF0KGkpKSB7XG4gICAgICBjYXNlIDM0OiBlc2NhcGUgPSAnJnF1b3Q7JzsgYnJlYWs7XG4gICAgICBjYXNlIDM4OiBlc2NhcGUgPSAnJmFtcDsnOyBicmVhaztcbiAgICAgIGNhc2UgNjA6IGVzY2FwZSA9ICcmbHQ7JzsgYnJlYWs7XG4gICAgICBjYXNlIDYyOiBlc2NhcGUgPSAnJmd0Oyc7IGJyZWFrO1xuICAgICAgZGVmYXVsdDogY29udGludWU7XG4gICAgfVxuICAgIGlmIChsYXN0SW5kZXggIT09IGkpIHJlc3VsdCArPSBodG1sLnN1YnN0cmluZyhsYXN0SW5kZXgsIGkpO1xuICAgIGxhc3RJbmRleCA9IGkgKyAxO1xuICAgIHJlc3VsdCArPSBlc2NhcGU7XG4gIH1cbiAgaWYgKGxhc3RJbmRleCAhPT0gaSkgcmV0dXJuIHJlc3VsdCArIGh0bWwuc3Vic3RyaW5nKGxhc3RJbmRleCwgaSk7XG4gIGVsc2UgcmV0dXJuIHJlc3VsdDtcbn07XG5cbi8qKlxuICogUmUtdGhyb3cgdGhlIGdpdmVuIGBlcnJgIGluIGNvbnRleHQgdG8gdGhlXG4gKiB0aGUgcHVnIGluIGBmaWxlbmFtZWAgYXQgdGhlIGdpdmVuIGBsaW5lbm9gLlxuICpcbiAqIEBwYXJhbSB7RXJyb3J9IGVyclxuICogQHBhcmFtIHtTdHJpbmd9IGZpbGVuYW1lXG4gKiBAcGFyYW0ge1N0cmluZ30gbGluZW5vXG4gKiBAcGFyYW0ge1N0cmluZ30gc3RyIG9yaWdpbmFsIHNvdXJjZVxuICogQGFwaSBwcml2YXRlXG4gKi9cblxuZXhwb3J0cy5yZXRocm93ID0gcHVnX3JldGhyb3c7XG5mdW5jdGlvbiBwdWdfcmV0aHJvdyhlcnIsIGZpbGVuYW1lLCBsaW5lbm8sIHN0cil7XG4gIGlmICghKGVyciBpbnN0YW5jZW9mIEVycm9yKSkgdGhyb3cgZXJyO1xuICBpZiAoKHR5cGVvZiB3aW5kb3cgIT0gJ3VuZGVmaW5lZCcgfHwgIWZpbGVuYW1lKSAmJiAhc3RyKSB7XG4gICAgZXJyLm1lc3NhZ2UgKz0gJyBvbiBsaW5lICcgKyBsaW5lbm87XG4gICAgdGhyb3cgZXJyO1xuICB9XG4gIHRyeSB7XG4gICAgc3RyID0gc3RyIHx8IF9fd2VicGFja19yZXF1aXJlX18oMTQpLnJlYWRGaWxlU3luYyhmaWxlbmFtZSwgJ3V0ZjgnKVxuICB9IGNhdGNoIChleCkge1xuICAgIHB1Z19yZXRocm93KGVyciwgbnVsbCwgbGluZW5vKVxuICB9XG4gIHZhciBjb250ZXh0ID0gM1xuICAgICwgbGluZXMgPSBzdHIuc3BsaXQoJ1xcbicpXG4gICAgLCBzdGFydCA9IE1hdGgubWF4KGxpbmVubyAtIGNvbnRleHQsIDApXG4gICAgLCBlbmQgPSBNYXRoLm1pbihsaW5lcy5sZW5ndGgsIGxpbmVubyArIGNvbnRleHQpO1xuXG4gIC8vIEVycm9yIGNvbnRleHRcbiAgdmFyIGNvbnRleHQgPSBsaW5lcy5zbGljZShzdGFydCwgZW5kKS5tYXAoZnVuY3Rpb24obGluZSwgaSl7XG4gICAgdmFyIGN1cnIgPSBpICsgc3RhcnQgKyAxO1xuICAgIHJldHVybiAoY3VyciA9PSBsaW5lbm8gPyAnICA+ICcgOiAnICAgICcpXG4gICAgICArIGN1cnJcbiAgICAgICsgJ3wgJ1xuICAgICAgKyBsaW5lO1xuICB9KS5qb2luKCdcXG4nKTtcblxuICAvLyBBbHRlciBleGNlcHRpb24gbWVzc2FnZVxuICBlcnIucGF0aCA9IGZpbGVuYW1lO1xuICBlcnIubWVzc2FnZSA9IChmaWxlbmFtZSB8fCAnUHVnJykgKyAnOicgKyBsaW5lbm9cbiAgICArICdcXG4nICsgY29udGV4dCArICdcXG5cXG4nICsgZXJyLm1lc3NhZ2U7XG4gIHRocm93IGVycjtcbn07XG5cblxuLyoqKi8gfSksXG4vKiAxICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblwidXNlIHN0cmljdFwiO1xuXG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbnZhciBfY2hhdCA9IF9fd2VicGFja19yZXF1aXJlX18oOCk7XG5cbnZhciBfY2hhdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jaGF0KTtcblxudmFyIF9tZXNzYWdlVG1wbCA9IF9fd2VicGFja19yZXF1aXJlX18oMTEpO1xuXG52YXIgX21lc3NhZ2VUbXBsMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX21lc3NhZ2VUbXBsKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBDaGF0TWVzc2FnZVxuICogQHByb3BlcnR5IHtzdHJpbmd9IHVzZXJJZFxuICogQHByb3BlcnR5IHtzdHJpbmd9IHVzZXJuYW1lXG4gKiBAcHJvcGVydHkge3N0cmluZ30gYXZhdGFyVXJsXG4gKiBAcHJvcGVydHkge0RhdGV9IGRhdGVcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBtZXNzYWdlXG4gKi9cblxudmFyIENoYXQgPSBmdW5jdGlvbiAoKSB7XG5cbiAgLyoqXG4gICAqIENyZWF0ZSBjb250YWluZXIgZWxlbWVudCwgaW5pdCBldmVudHMuXG4gICAqIEBwYXJhbSB7SHRtbEVsZW1lbnR9IGVsXG4gICAqIEBwYXJhbSB7VXNlcn0gY3VycmVudFVzZXJcbiAgICovXG4gIGZ1bmN0aW9uIENoYXQoX3JlZikge1xuICAgIHZhciBlbCA9IF9yZWYuZWwsXG4gICAgICAgIGN1cnJlbnRVc2VyID0gX3JlZi5jdXJyZW50VXNlcjtcblxuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBDaGF0KTtcblxuICAgIHRoaXMuZWwgPSBlbDtcbiAgICB0aGlzLmN1cnJlbnRVc2VyID0gY3VycmVudFVzZXI7XG4gICAgdGhpcy5jb250YWluZXJFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3VsJyk7XG4gICAgdGhpcy5jb250YWluZXJFbC5jbGFzc05hbWUgPSAnY2hhdF9fbWVzc2FnZXMnO1xuICAgIHRoaXMuZWwuYXBwZW5kQ2hpbGQodGhpcy5jb250YWluZXJFbCk7XG4gICAgdGhpcy5wcm9jZXNzZWRNZXNzYWdlcyA9IHt9O1xuICAgIHRoaXMuaW5pdEV2ZW50cygpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldCBldmVudCBoYW5kbGVyLlxuICAgKiBAcGFyYW0ge2V2ZW50fSBldmVudFxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBoYW5kbGVyXG4gICAqL1xuXG5cbiAgX2NyZWF0ZUNsYXNzKENoYXQsIFt7XG4gICAga2V5OiAnb24nLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBvbihldmVudCwgaGFuZGxlcikge1xuICAgICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgZXhpc3RzIG1lc3NhZ2VzIG9uIHRoZSBjaGF0LlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBtZXNzYWdlcyB0aGUge0NoYXRNZXNzYWdlfSBvYmplY3QgKG9iamVjdCBrZXkgPT09IG1lc3NhZ2VJZCkuXG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogJ3VwZGF0ZU1lc3NhZ2VzJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlTWVzc2FnZXMobWVzc2FnZXMpIHtcbiAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICAgIHZhciBpZHMgPSBPYmplY3Qua2V5cyhtZXNzYWdlcyk7XG4gICAgICB2YXIgbGFzdEV4aXN0TWVzc2FnZUlkID0gdm9pZCAwO1xuICAgICAgaWRzLmZvckVhY2goZnVuY3Rpb24gKG1lc3NhZ2VJZCkge1xuICAgICAgICBpZiAoX3RoaXMucHJvY2Vzc2VkTWVzc2FnZXNbbWVzc2FnZUlkXSkge1xuICAgICAgICAgIGxhc3RFeGlzdE1lc3NhZ2VJZCA9IG1lc3NhZ2VJZDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBfdGhpcy5pbnNlcnRNZXNzYWdlKG1lc3NhZ2VJZCwgbWVzc2FnZXNbbWVzc2FnZUlkXSwgbGFzdEV4aXN0TWVzc2FnZUlkKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICB0aGlzLnNjcm9sbFRvQm90dG9tKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlIG1lc3NhZ2UgZnJvbSBhIGNoYXQuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG1lc3NhZ2VJZFxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdkZWxldGVNZXNzYWdlJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gZGVsZXRlTWVzc2FnZShtZXNzYWdlSWQpIHtcbiAgICAgIGlmICghdGhpcy5wcm9jZXNzZWRNZXNzYWdlc1ttZXNzYWdlSWRdKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZhciBtZXNzYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobWVzc2FnZUlkKTtcbiAgICAgIGlmICghbWVzc2FnZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aGlzLmNvbnRhaW5lckVsLnJlbW92ZUNoaWxkKG1lc3NhZ2UpO1xuICAgICAgZGVsZXRlIHRoaXMucHJvY2Vzc2VkTWVzc2FnZXNbbWVzc2FnZUlkXTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJbnNlcnQgYSBuZXcgbWVzc2FnZSBhZnRlciBkZXNjcmliZWQgbWVzc2FnZSAoaWYgcHJlc2VudCkgb3IgYXQgdGhlIGVuZCBvdGhlcndpc2UuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG1lc3NhZ2VJZCBUaGUgbWVzc2FnZSBJRC5cbiAgICAgKiBAcGFyYW0ge0NoYXRNZXNzYWdlfSBtZXNzYWdlIFRoZSBtZXNzYWdlLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBhZnRlck1lc3NhZ2VJZFxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdpbnNlcnRNZXNzYWdlJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gaW5zZXJ0TWVzc2FnZShtZXNzYWdlSWQsIG1lc3NhZ2UpIHtcbiAgICAgIHZhciBhZnRlck1lc3NhZ2VJZCA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogMDtcblxuICAgICAgdGhpcy5wcm9jZXNzZWRNZXNzYWdlc1ttZXNzYWdlSWRdID0gdHJ1ZTtcbiAgICAgIGlmIChhZnRlck1lc3NhZ2VJZCAmJiB0aGlzLnByb2Nlc3NlZE1lc3NhZ2VzW2FmdGVyTWVzc2FnZUlkXSkge1xuICAgICAgICB2YXIgYWZ0ZXJFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGFmdGVyTWVzc2FnZUlkKTtcbiAgICAgICAgaWYgKGFmdGVyRWwpIHtcbiAgICAgICAgICBhZnRlckVsLmluc2VydEFkamFjZW50SFRNTCgnYWZ0ZXJFbmQnLCB0aGlzLnJlbmRlckl0ZW0obWVzc2FnZUlkLCBtZXNzYWdlKSk7XG4gICAgICAgICAgdGhpcy5wcm9jZXNzZWRNZXNzYWdlc1thZnRlck1lc3NhZ2VJZF0gPSB0cnVlO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdGhpcy5jb250YWluZXJFbC5pbnNlcnRBZGphY2VudEhUTUwoJ2JlZm9yZUVuZCcsIHRoaXMucmVuZGVySXRlbShtZXNzYWdlSWQsIG1lc3NhZ2UpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJbml0IHRoZSBtZXNzYWdlIGV2ZW50cy5cbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiAnaW5pdEV2ZW50cycsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRFdmVudHMoKSB7XG4gICAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5jbGljay5iaW5kKHRoaXMpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGF0IG1lc3NhZ2UgY2xpY2sgaGFuZGxlclxuICAgICAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50XG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogJ2NsaWNrJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gY2xpY2soZXZlbnQpIHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBpZiAoZXZlbnQudGFyZ2V0LnR5cGUgIT09ICdidXR0b24nKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZhciBtZXNzYWdlSXRlbSA9IGV2ZW50LnRhcmdldC5jbG9zZXN0KCdsaS5jaGF0X19tZXNzYWdlJyk7XG4gICAgICBpZiAoIW1lc3NhZ2VJdGVtIHx8ICFtZXNzYWdlSXRlbS5pZCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB2YXIgZGVsZXRlRXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoJ21lc3NhZ2VEZWxldGUnLCB7IGRldGFpbDogeyBtZXNzYWdlSWQ6IG1lc3NhZ2VJdGVtLmlkIH0gfSk7XG4gICAgICB0aGlzLmVsLmRpc3BhdGNoRXZlbnQoZGVsZXRlRXZlbnQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNjcm9sbCBjaGF0IHdpbmRvdyB0byBib3R0b20uXG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogJ3Njcm9sbFRvQm90dG9tJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gc2Nyb2xsVG9Cb3R0b20oKSB7XG4gICAgICB0aGlzLmVsLnNjcm9sbFRvcCA9IHRoaXMuZWwuc2Nyb2xsSGVpZ2h0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbmRlciB0aGUgbWVzc2FnZSBiYXNlZCBvbiB0ZW1wbGF0ZS5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZUlkIFRoZSBtZXNzYWdlIElELlxuICAgICAqIEBwYXJhbSB7Q2hhdE1lc3NhZ2V9IG1lc3NhZ2UgVGhlIG1lc3NhZ2UuXG4gICAgICogQHJldHVybnMge3N0cmluZ31cbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiAncmVuZGVySXRlbScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlckl0ZW0obWVzc2FnZUlkLCBtZXNzYWdlKSB7XG4gICAgICByZXR1cm4gKDAsIF9tZXNzYWdlVG1wbDIuZGVmYXVsdCkoe1xuICAgICAgICBpZDogbWVzc2FnZUlkLFxuICAgICAgICBpc093bjogdGhpcy5jdXJyZW50VXNlci51c2VySWQgPT09IG1lc3NhZ2UudXNlcklkLFxuICAgICAgICB1c2VybmFtZTogbWVzc2FnZS51c2VybmFtZSB8fCB0aGlzLmN1cnJlbnRVc2VyLmRlZmF1bHRVc2VybmFtZSxcbiAgICAgICAgYXZhdGFyVXJsOiBtZXNzYWdlLmF2YXRhclVybCB8fCB0aGlzLmN1cnJlbnRVc2VyLmRlZmF1bHRBdmF0YXJVcmwsXG4gICAgICAgIGRhdGU6IG5ldyBEYXRlKG1lc3NhZ2UuZGF0ZSksXG4gICAgICAgIHRleHQ6IG1lc3NhZ2UubWVzc2FnZVxuICAgICAgfSk7XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIENoYXQ7XG59KCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IENoYXQ7XG5cbi8qKiovIH0pLFxuLyogMiAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcblxuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG52YXIgX21lc3NhZ2VGb3JtID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTtcblxudmFyIF9tZXNzYWdlRm9ybTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tZXNzYWdlRm9ybSk7XG5cbnZhciBfZm9ybVRtcGwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyKTtcblxudmFyIF9mb3JtVG1wbDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9mb3JtVG1wbCk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbnZhciBNZXNzYWdlRm9ybSA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gTWVzc2FnZUZvcm0oX3JlZikge1xuICAgIHZhciBlbCA9IF9yZWYuZWw7XG5cbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTWVzc2FnZUZvcm0pO1xuXG4gICAgdGhpcy5lbCA9IGVsO1xuICAgIHRoaXMuaW5pdEV2ZW50cygpO1xuICB9XG5cbiAgLyoqXG4gICAqIEluaXQgdGhlIG1lc3NhZ2UgZXZlbnRzLlxuICAgKi9cblxuXG4gIF9jcmVhdGVDbGFzcyhNZXNzYWdlRm9ybSwgW3tcbiAgICBrZXk6ICdpbml0RXZlbnRzJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdEV2ZW50cygpIHtcbiAgICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgdGhpcy5tZXNzYWdlU3VibWl0LmJpbmQodGhpcykpO1xuICAgICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5rZXlEb3duLmJpbmQodGhpcykpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldCBldmVudCBoYW5kbGVyLlxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdvbicsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIG9uKGV2ZW50LCBoYW5kbGVyKSB7XG4gICAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZXIpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBzdWJtaXR0ZWQgbWVzc2FnZSBhbmQgdGhlbiBjbGVhciB0aGUgZWxlbWVudCB2YWx1ZS5cbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdnZXRNZXNzYWdlJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TWVzc2FnZSgpIHtcbiAgICAgIGlmICghdGhpcy5pbnB1dEVsKSB7XG4gICAgICAgIHRoaXMuaW5wdXRFbCA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcignW25hbWU9XCJtZXNzYWdlXCJdJyk7XG4gICAgICB9XG4gICAgICB2YXIgbWVzc2FnZSA9IHRoaXMuaW5wdXRFbC52YWx1ZTtcbiAgICAgIHRoaXMuaW5wdXRFbC52YWx1ZSA9ICcnO1xuICAgICAgcmV0dXJuIG1lc3NhZ2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogS2V5RG93biBldmVudCBoYW5kbGVyXG4gICAgICogQHBhcmFtIHtFdmVudH0gZXZlbnRcbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiAnbWVzc2FnZVN1Ym1pdCcsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIG1lc3NhZ2VTdWJtaXQoZXZlbnQpIHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB2YXIgbWVzc2FnZSA9IHRoaXMuZ2V0TWVzc2FnZSgpO1xuICAgICAgaWYgKCFtZXNzYWdlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZhciBvblN1Ym1pdEV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KCdtZXNzYWdlU3VibWl0JywgeyBkZXRhaWw6IHsgbWVzc2FnZTogbWVzc2FnZSB9IH0pO1xuICAgICAgdGhpcy5lbC5kaXNwYXRjaEV2ZW50KG9uU3VibWl0RXZlbnQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE1lc3NhZ2Ugc3VibWl0IGhhbmRsZXJcbiAgICAgKiBAcGFyYW0ge0V2ZW50fSBldmVudFxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdrZXlEb3duJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24ga2V5RG93bihldmVudCkge1xuICAgICAgaWYgKGV2ZW50LndoaWNoICE9PSAxMyB8fCBldmVudC5hbHRLZXkgfHwgZXZlbnQuY3RybEtleSB8fCBldmVudC5zaGlmdEtleSB8fCBldmVudC5tZXRhS2V5KSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLm1lc3NhZ2VTdWJtaXQoZXZlbnQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbmRlciB0aGUgbWVzc2FnZSBmb3JtIGJsb2NrLlxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdyZW5kZXInLFxuICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7XG4gICAgICB0aGlzLmVsLmlubmVySFRNTCA9ICgwLCBfZm9ybVRtcGwyLmRlZmF1bHQpKCk7XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIE1lc3NhZ2VGb3JtO1xufSgpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBNZXNzYWdlRm9ybTtcblxuLyoqKi8gfSksXG4vKiAzICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblwidXNlIHN0cmljdFwiO1xuXG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbnZhciBfdXNlciA9IF9fd2VicGFja19yZXF1aXJlX18oMTApO1xuXG52YXIgX3VzZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdXNlcik7XG5cbnZhciBfdXNlclRtcGwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzKTtcblxudmFyIF91c2VyVG1wbDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF91c2VyVG1wbCk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbnZhciBBTk9OSU1PVVNfVVNFUk5BTUUgPSAn0JDQvdC+0L3QuNC8JztcbnZhciBERUZBVUxUX0FWQVRBUiA9ICcuL2NvbXBvbmVudHMvdXNlci9ub0F2YXRhci5qcGcnO1xuXG4vKipcbiAqIEB0eXBlZGVmIHtPYmplY3R9IFVzZXJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSB1c2VySWRcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSB1c2VybmFtZVxuICogQHByb3BlcnR5IHtzdHJpbmd9IGF2YXRhclVybFxuICovXG5cbnZhciBVc2VyID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBVc2VyKF9yZWYpIHtcbiAgICB2YXIgZWwgPSBfcmVmLmVsLFxuICAgICAgICBTdG9yYWdlID0gX3JlZi5TdG9yYWdlO1xuXG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFVzZXIpO1xuXG4gICAgdGhpcy5lbCA9IGVsO1xuICAgIHRoaXMuc3RvcmFnZSA9IG5ldyBTdG9yYWdlKCk7XG4gICAgdGhpcy5pbml0RXZlbnRzKCk7XG4gICAgdGhpcy5kYXRhID0ge1xuICAgICAgdXNlcklkOiB0aGlzLnN0b3JhZ2UuZ2V0SXRlbSgndXNlcklkJykgfHwgJ2Fub25pbW91cy0nICsgKE1hdGgucmFuZG9tKCkgKiAxMDAwMDAwMDAwKS50b0ZpeGVkKCksXG4gICAgICB1c2VybmFtZTogdGhpcy5zdG9yYWdlLmdldEl0ZW0oJ3VzZXJuYW1lJyksXG4gICAgICBhdmF0YXJVcmw6IHRoaXMuc3RvcmFnZS5nZXRJdGVtKCdhdmF0YXJVcmwnKVxuICAgIH07XG4gICAgdGhpcy5zYXZlVXNlclRvU3RvcmFnZSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEluaXQgdGhlIHVzZXIgZXZlbnRzLlxuICAgKi9cblxuXG4gIF9jcmVhdGVDbGFzcyhVc2VyLCBbe1xuICAgIGtleTogJ2luaXRFdmVudHMnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0RXZlbnRzKCkge1xuICAgICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuY2xpY2suYmluZCh0aGlzKSk7XG4gICAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHRoaXMuc3VibWl0LmJpbmQodGhpcykpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgdXNlciBJRC5cbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdzYXZlVXNlclRvU3RvcmFnZScsXG5cblxuICAgIC8qKlxuICAgICAqIFNldCBjdXJyZW50IHVzZXIgc2V0dGluZ3MgdG8gc3RvcmFnZS5cbiAgICAgKi9cbiAgICB2YWx1ZTogZnVuY3Rpb24gc2F2ZVVzZXJUb1N0b3JhZ2UoKSB7XG4gICAgICB0aGlzLnN0b3JhZ2Uuc2V0SXRlbSgndXNlcklkJywgdGhpcy5kYXRhLnVzZXJJZCk7XG4gICAgICBpZiAodGhpcy5kYXRhLnVzZXJuYW1lKSB7XG4gICAgICAgIHRoaXMuc3RvcmFnZS5zZXRJdGVtKCd1c2VybmFtZScsIHRoaXMuZGF0YS51c2VybmFtZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnN0b3JhZ2UucmVtb3ZlSXRlbSgndXNlcm5hbWUnKTtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLmRhdGEuYXZhdGFyVXJsKSB7XG4gICAgICAgIHRoaXMuc3RvcmFnZS5zZXRJdGVtKCdhdmF0YXJVcmwnLCB0aGlzLmRhdGEuYXZhdGFyVXJsKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuc3RvcmFnZS5yZW1vdmVJdGVtKCdhdmF0YXJVcmwnKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTdWJtaXQgZXZlbnQgaGFuZGxlci5cbiAgICAgKiBAcGFyYW0ge0V2ZW50fSBldmVudFxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdzdWJtaXQnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBzdWJtaXQoZXZlbnQpIHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBpZiAoZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygndXNlci1mb3JtJykgJiYgZXZlbnQudGFyZ2V0LmRhdGFzZXQuYWN0aW9uICYmIHRoaXNbZXZlbnQudGFyZ2V0LmRhdGFzZXQuYWN0aW9uXSkge1xuICAgICAgICB0aGlzW2V2ZW50LnRhcmdldC5kYXRhc2V0LmFjdGlvbl0oZXZlbnQpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsaWNrIGV2ZW50IGhhbmRsZXIuXG4gICAgICogQHBhcmFtIHtFdmVudH0gZXZlbnRcbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiAnY2xpY2snLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBjbGljayhldmVudCkge1xuICAgICAgaWYgKGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3RvZ2dsZScpICYmIGV2ZW50LnRhcmdldC5kYXRhc2V0LnRvZ2dsZSkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoJ1tuYW1lPXVzZXJuYW1lXScpLnZhbHVlID0gdGhpcy51c2VybmFtZTtcbiAgICAgICAgdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCdbbmFtZT1hdmF0YXJVcmxdJykudmFsdWUgPSB0aGlzLmRhdGEuYXZhdGFyVXJsIHx8ICcnO1xuICAgICAgICB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoJy51c2VyIC51c2VyLWZvcm1fXycgKyBldmVudC50YXJnZXQuZGF0YXNldC50b2dnbGUpLmNsYXNzTGlzdC50b2dnbGUoJ2hpZGRlbicpO1xuICAgICAgICBpZiAoZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygndG9nZ2xlZCcpKSB7XG4gICAgICAgICAgZXZlbnQudGFyZ2V0LmhpZGRlbiA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgdXNlciBhdmF0YXIuXG4gICAgICogQHBhcmFtIHtFdmVudH0gZXZlbnRcbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiAnc2V0QXZhdGFyJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0QXZhdGFyKGV2ZW50KSB7XG4gICAgICB2YXIgZWwgPSBldmVudC50YXJnZXQucXVlcnlTZWxlY3RvcignW25hbWU9YXZhdGFyVXJsXScpO1xuICAgICAgLy8gICAgICBpZiAoZWwgJiYgZWwudmFsdWUgJiYgZWwudmFsdWUubWF0Y2goLy4oanBnfGpwZWd8cG5nfGdpZikkL2kpKSB7XG4gICAgICBpZiAoZWwgJiYgZWwudmFsdWUpIHtcbiAgICAgICAgdGhpcy5kYXRhLmF2YXRhclVybCA9IGVsLnZhbHVlO1xuICAgICAgfVxuICAgICAgdGhpcy5zYXZlVXNlclRvU3RvcmFnZSgpO1xuICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgdXNlcm5hbWUuXG4gICAgICogQHBhcmFtIHtFdmVudH0gZXZlbnRcbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiAnc2V0VXNlcm5hbWUnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRVc2VybmFtZShldmVudCkge1xuICAgICAgdmFyIGVsID0gZXZlbnQudGFyZ2V0LnF1ZXJ5U2VsZWN0b3IoJ1tuYW1lPXVzZXJuYW1lXScpO1xuICAgICAgaWYgKGVsICYmIGVsLnZhbHVlKSB7XG4gICAgICAgIHRoaXMuZGF0YS51c2VybmFtZSA9IGVsLnZhbHVlO1xuICAgICAgICB0aGlzLnVzZXJJZCA9IGVsLnZhbHVlO1xuICAgICAgfVxuICAgICAgdGhpcy5zYXZlVXNlclRvU3RvcmFnZSgpO1xuICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW5kZXIgdGhlIHVzZXIgZGF0YSBibG9jay5cbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiAncmVuZGVyJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkge1xuICAgICAgdGhpcy5lbC5pbm5lckhUTUwgPSAoMCwgX3VzZXJUbXBsMi5kZWZhdWx0KSh0aGlzKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICd1c2VySWQnLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMuZGF0YS51c2VySWQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0IHRoZSB1c2VyIElEIGJ5IGEgdXNlcm5hbWUuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVzZXJuYW1lXG4gICAgICovXG4gICAgLFxuICAgIHNldDogZnVuY3Rpb24gc2V0KHVzZXJuYW1lKSB7XG4gICAgICBpZiAodXNlcm5hbWUpIHtcbiAgICAgICAgdGhpcy5kYXRhLnVzZXJJZCA9IHVzZXJuYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSB1c2VybmFtZS5cbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICd1c2VybmFtZScsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4gdGhpcy5kYXRhLnVzZXJuYW1lIHx8IEFOT05JTU9VU19VU0VSTkFNRTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgZGVmYXVsdCB1c2VybmFtZS5cbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdkZWZhdWx0VXNlcm5hbWUnLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIEFOT05JTU9VU19VU0VSTkFNRTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIHVzZXIgYXZhdGFyIFVSTC5cbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdhdmF0YXJVcmwnLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMuZGF0YS5hdmF0YXJVcmwgfHwgREVGQVVMVF9BVkFUQVI7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGRlZmF1bHQgYXZhdGFyIFVSTC5cbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdkZWZhdWx0QXZhdGFyVXJsJyxcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiBERUZBVUxUX0FWQVRBUjtcbiAgICB9XG4gIH1dKTtcblxuICByZXR1cm4gVXNlcjtcbn0oKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gVXNlcjtcblxuLyoqKi8gfSksXG4vKiA0ICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblwidXNlIHN0cmljdFwiO1xuXG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbnZhciBIdHRwUmVxdWVzdCA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gSHR0cFJlcXVlc3Qoc2VydmVyVXJsKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEh0dHBSZXF1ZXN0KTtcblxuICAgIHRoaXMuc2VydmVyVXJsID0gc2VydmVyVXJsO1xuICB9XG5cbiAgX2NyZWF0ZUNsYXNzKEh0dHBSZXF1ZXN0LCBbe1xuICAgIGtleTogJ3NlbmRSZXF1ZXN0JyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gc2VuZFJlcXVlc3QoX3JlZikge1xuICAgICAgdmFyIF9yZWYkdHlwZSA9IF9yZWYudHlwZSxcbiAgICAgICAgICB0eXBlID0gX3JlZiR0eXBlID09PSB1bmRlZmluZWQgPyAnR0VUJyA6IF9yZWYkdHlwZSxcbiAgICAgICAgICBwYXRoID0gX3JlZi5wYXRoLFxuICAgICAgICAgIF9yZWYkZGF0YSA9IF9yZWYuZGF0YSxcbiAgICAgICAgICBkYXRhID0gX3JlZiRkYXRhID09PSB1bmRlZmluZWQgPyB7fSA6IF9yZWYkZGF0YTtcblxuICAgICAgdmFyIHJlcXVlc3QgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgIHJlcXVlc3Qub3Blbih0eXBlLCB0aGlzLnNlcnZlclVybCArICcvJyArIHBhdGgsIHRydWUpO1xuICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJlc29sdmUoSlNPTi5wYXJzZShyZXF1ZXN0LnJlc3BvbnNlVGV4dCkpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgIHZhciBlcnJvciA9IG5ldyBFcnJvcihldmVudC50YXJnZXQuc3RhdHVzVGV4dCk7XG4gICAgICAgICAgZXJyb3IuY29kZSA9IGV2ZW50LnRhcmdldC5zdGF0dXM7XG4gICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJlcXVlc3Quc2VuZChKU09OLnN0cmluZ2lmeShkYXRhKSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgYWxsIG1lc3NhZ2VzLlxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdnZXRBbGxNZXNzYWdlcycsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGdldEFsbE1lc3NhZ2VzKCkge1xuICAgICAgcmV0dXJuIHRoaXMuc2VuZFJlcXVlc3Qoe1xuICAgICAgICBwYXRoOiAnbWVzc2FnZXMuanNvbidcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgbWVzc2FnZSBieSBtZXNzYWdlSWQuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG1lc3NhZ2VJZFxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdnZXRNZXNzYWdlJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TWVzc2FnZShtZXNzYWdlSWQpIHtcbiAgICAgIHJldHVybiB0aGlzLnNlbmRSZXF1ZXN0KHtcbiAgICAgICAgcGF0aDogJ21lc3NhZ2VzLycgKyBtZXNzYWdlSWQgKyAnLmpzb24nXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgdGhlIG1lc3NhZ2UgYnkgbWVzc2FnZUlkLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlSWRcbiAgICAgKiBAcGFyYW0ge0NoYXRNZXNzYWdlfSBtZXNzYWdlXG4gICAgICogQHJldHVybnMge1Byb21pc2V9XG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogJ21lc3NhZ2VVcGRhdGUnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBtZXNzYWdlVXBkYXRlKG1lc3NhZ2VJZCwgbWVzc2FnZSkge1xuICAgICAgcmV0dXJuIHRoaXMuc2VuZFJlcXVlc3Qoe1xuICAgICAgICB0eXBlOiAnUFVUJyxcbiAgICAgICAgcGF0aDogJ21lc3NhZ2VzLycgKyBtZXNzYWdlSWQgKyAnLmpzb24nLFxuICAgICAgICBkYXRhOiBtZXNzYWdlXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZW5kIGEgbmV3IG1lc3NhZ2UuXG4gICAgICogQHBhcmFtIHtDaGF0TWVzc2FnZX0gbWVzc2FnZVxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlfVxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdtZXNzYWdlQWRkJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gbWVzc2FnZUFkZChtZXNzYWdlKSB7XG4gICAgICByZXR1cm4gdGhpcy5zZW5kUmVxdWVzdCh7XG4gICAgICAgIHR5cGU6ICdQT1NUJyxcbiAgICAgICAgcGF0aDogJ21lc3NhZ2VzLmpzb24nLFxuICAgICAgICBkYXRhOiBtZXNzYWdlXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZWxldGUgdGhlIG1lc3NhZ2UgYnkgbWVzc2FnZUlkLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlSWRcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZX1cbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiAnbWVzc2FnZURlbGV0ZScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIG1lc3NhZ2VEZWxldGUobWVzc2FnZUlkKSB7XG4gICAgICByZXR1cm4gdGhpcy5zZW5kUmVxdWVzdCh7XG4gICAgICAgIHR5cGU6ICdERUxFVEUnLFxuICAgICAgICBwYXRoOiAnbWVzc2FnZXMvJyArIG1lc3NhZ2VJZCArICcuanNvbidcbiAgICAgIH0pO1xuICAgIH1cbiAgfV0pO1xuXG4gIHJldHVybiBIdHRwUmVxdWVzdDtcbn0oKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gSHR0cFJlcXVlc3Q7XG5cbi8qKiovIH0pLFxuLyogNSAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcblxuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG52YXIgU3RvcmFnZSA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gU3RvcmFnZSgpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU3RvcmFnZSk7XG5cbiAgICB0aGlzLnN0b3JhZ2UgPSB3aW5kb3cubG9jYWxTdG9yYWdlO1xuICB9XG5cbiAgX2NyZWF0ZUNsYXNzKFN0b3JhZ2UsIFt7XG4gICAga2V5OiBcImdldEl0ZW1cIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0SXRlbShrZXkpIHtcbiAgICAgIHJldHVybiB0aGlzLnN0b3JhZ2UuZ2V0SXRlbShrZXkpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJzZXRJdGVtXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHNldEl0ZW0oa2V5LCB2YWx1ZSkge1xuICAgICAgcmV0dXJuIHRoaXMuc3RvcmFnZS5zZXRJdGVtKGtleSwgdmFsdWUpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJyZW1vdmVJdGVtXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZUl0ZW0oa2V5KSB7XG4gICAgICByZXR1cm4gdGhpcy5zdG9yYWdlLnJlbW92ZUl0ZW0oa2V5KTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiY2xlYXJcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gY2xlYXIoKSB7XG4gICAgICByZXR1cm4gdGhpcy5zdG9yYWdlLmNsZWFyKCk7XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIFN0b3JhZ2U7XG59KCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IFN0b3JhZ2U7XG5cbi8qKiovIH0pLFxuLyogNiAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG4vLyByZW1vdmVkIGJ5IGV4dHJhY3QtdGV4dC13ZWJwYWNrLXBsdWdpblxuXG4vKioqLyB9KSxcbi8qIDcgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxudmFyIF9hcHAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpO1xuXG52YXIgX2FwcDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9hcHApO1xuXG52YXIgX3N0b3JhZ2UgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpO1xuXG52YXIgX3N0b3JhZ2UyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc3RvcmFnZSk7XG5cbnZhciBfaHR0cFJlcXVlc3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpO1xuXG52YXIgX2h0dHBSZXF1ZXN0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2h0dHBSZXF1ZXN0KTtcblxudmFyIF9jaGF0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKTtcblxudmFyIF9jaGF0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NoYXQpO1xuXG52YXIgX3VzZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpO1xuXG52YXIgX3VzZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdXNlcik7XG5cbnZhciBfbWVzc2FnZUZvcm0gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpO1xuXG52YXIgX21lc3NhZ2VGb3JtMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX21lc3NhZ2VGb3JtKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxudmFyIHNlcnZlclJlcXVlc3QgPSBuZXcgX2h0dHBSZXF1ZXN0Mi5kZWZhdWx0KCdodHRwczovL21ldmxjaGF0LmZpcmViYXNlaW8uY29tJyk7XG52YXIgVVBEQVRFX01FU1NBR0VTX0lOVEVSVkFMID0gMzAwMDtcblxudmFyIEFwcCA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gQXBwKF9yZWYpIHtcbiAgICB2YXIgdXNlckVsID0gX3JlZi51c2VyRWwsXG4gICAgICAgIG1lc3NhZ2VGb3JtRWwgPSBfcmVmLm1lc3NhZ2VGb3JtRWwsXG4gICAgICAgIGNoYXRFbCA9IF9yZWYuY2hhdEVsO1xuXG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEFwcCk7XG5cbiAgICB0aGlzLnVzZXIgPSBuZXcgX3VzZXIyLmRlZmF1bHQoeyBlbDogdXNlckVsLCBTdG9yYWdlOiBfc3RvcmFnZTIuZGVmYXVsdCB9KTtcbiAgICB0aGlzLmNoYXQgPSBuZXcgX2NoYXQyLmRlZmF1bHQoeyBlbDogY2hhdEVsLCBjdXJyZW50VXNlcjogdGhpcy51c2VyIH0pO1xuICAgIHRoaXMubWVzc2FnZUZvcm0gPSBuZXcgX21lc3NhZ2VGb3JtMi5kZWZhdWx0KHsgZWw6IG1lc3NhZ2VGb3JtRWwgfSk7XG4gICAgdGhpcy5pbml0RXZlbnRzKCk7XG4gIH1cblxuICAvKipcbiAgICogSW5pdCB0aGUgYXBwbGljYXRpb24gZXZlbnRzLlxuICAgKi9cblxuXG4gIF9jcmVhdGVDbGFzcyhBcHAsIFt7XG4gICAga2V5OiAnaW5pdEV2ZW50cycsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRFdmVudHMoKSB7XG4gICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgICB0aGlzLm1lc3NhZ2VGb3JtLm9uKCdtZXNzYWdlU3VibWl0JywgdGhpcy5tZXNzYWdlU3VibWl0LmJpbmQodGhpcykpO1xuICAgICAgdGhpcy5jaGF0Lm9uKCdtZXNzYWdlRGVsZXRlJywgdGhpcy5kZWxldGVNZXNzYWdlLmJpbmQodGhpcykpO1xuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndmlzaWJpbGl0eWNoYW5nZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKGRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSA9PT0gJ2hpZGRlbicpIHtcbiAgICAgICAgICBfdGhpcy5zdG9wSW50ZXJ2YWxVcGRhdGUoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBfdGhpcy5zdGFydEludGVydmFsVXBkYXRlKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN0YXJ0IHBlcmlvZGljYWxseSBtZXNzYWdlcyB1cGRhdGluZy5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gaW50ZXJ2YWxcbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiAnc3RhcnRJbnRlcnZhbFVwZGF0ZScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHN0YXJ0SW50ZXJ2YWxVcGRhdGUoKSB7XG4gICAgICB2YXIgaW50ZXJ2YWwgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IFVQREFURV9NRVNTQUdFU19JTlRFUlZBTDtcblxuICAgICAgdGhpcy5pbnRlcnZhbFVwZGF0ZShpbnRlcnZhbCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3RhcnQgcGVyaW9kaWNhbGx5IG1lc3NhZ2VzIHVwZGF0aW5nLlxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdzdG9wSW50ZXJ2YWxVcGRhdGUnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBzdG9wSW50ZXJ2YWxVcGRhdGUoKSB7XG4gICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lcklkKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQZXJpb2RpY2FsbHkgbWVzc2FnZXMgdXBkYXRpbmcuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGludGVydmFsXG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogJ2ludGVydmFsVXBkYXRlJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gaW50ZXJ2YWxVcGRhdGUoaW50ZXJ2YWwpIHtcbiAgICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgICB0aGlzLnVwZGF0ZU1lc3NhZ2VzKCk7XG4gICAgICB0aGlzLnRpbWVySWQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3RoaXMyLmludGVydmFsVXBkYXRlLmNhbGwoX3RoaXMyLCBpbnRlcnZhbCk7XG4gICAgICB9LCBpbnRlcnZhbCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGFjdHVhbCBtZXNzYWdlcyBmcm9tIHRoZSBzZXJiZXIgYW5kIHVwZGF0ZSBtZXNzYWdlcyBsaXN0LlxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICd1cGRhdGVNZXNzYWdlcycsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZU1lc3NhZ2VzKCkge1xuICAgICAgdmFyIF90aGlzMyA9IHRoaXM7XG5cbiAgICAgIHNlcnZlclJlcXVlc3QuZ2V0QWxsTWVzc2FnZXMoKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICBfdGhpczMuY2hhdC51cGRhdGVNZXNzYWdlcyhyZXNwb25zZSk7XG4gICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgLy8gVE9ETzog0J7QsdGA0LDQsdC+0YLQsNGC0Ywg0L7RiNC40LHQutGDXG4gICAgICAgIGNvbnNvbGUubG9nKCdFcnJvcicsIGVycm9yKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENhbGxiYWNrIGZvciBtZXNzYWdlIHN1Ym1pdC4gTGluayBNZXNzYWdlRm9ybSBhbmQgQ2hhdCBjb21wb25lbnRzLlxuICAgICAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50XG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogJ21lc3NhZ2VTdWJtaXQnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBtZXNzYWdlU3VibWl0KGV2ZW50KSB7XG4gICAgICB2YXIgX3RoaXM0ID0gdGhpcztcblxuICAgICAgdmFyIG1lc3NhZ2UgPSB7XG4gICAgICAgIHVzZXJJZDogdGhpcy51c2VyLnVzZXJJZCxcbiAgICAgICAgdXNlcm5hbWU6IHRoaXMudXNlci5kYXRhLnVzZXJuYW1lLFxuICAgICAgICBhdmF0YXJVcmw6IHRoaXMudXNlci5kYXRhLmF2YXRhclVybCxcbiAgICAgICAgZGF0ZTogbmV3IERhdGUoKS5nZXRUaW1lKCksXG4gICAgICAgIG1lc3NhZ2U6IGV2ZW50LmRldGFpbC5tZXNzYWdlXG4gICAgICB9O1xuICAgICAgc2VydmVyUmVxdWVzdC5tZXNzYWdlQWRkKG1lc3NhZ2UpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICBfdGhpczQudXBkYXRlTWVzc2FnZXMoKTtcbiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAvLyBUT0RPOiDQntCx0YDQsNCx0L7RgtCw0YLRjCDQvtGI0LjQsdC60YNcbiAgICAgICAgY29uc29sZS5sb2coJ0Vycm9yJywgZXJyb3IpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2FsbGJhY2sgZm9yIG1lc3NhZ2UgZGVsZXRlLlxuICAgICAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50XG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogJ2RlbGV0ZU1lc3NhZ2UnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBkZWxldGVNZXNzYWdlKGV2ZW50KSB7XG4gICAgICB2YXIgX3RoaXM1ID0gdGhpcztcblxuICAgICAgdmFyIG1lc3NhZ2VJZCA9IGV2ZW50LmRldGFpbC5tZXNzYWdlSWQ7XG4gICAgICBzZXJ2ZXJSZXF1ZXN0Lm1lc3NhZ2VEZWxldGUobWVzc2FnZUlkKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3RoaXM1LmNoYXQuZGVsZXRlTWVzc2FnZShtZXNzYWdlSWQpO1xuICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgIC8vIFRPRE86INCe0LHRgNCw0LHQvtGC0LDRgtGMINC+0YjQuNCx0LrRg1xuICAgICAgICBjb25zb2xlLmxvZygnRXJyb3InLCBlcnJvcik7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW5kZXIgdGhlIGFwcGxpY2F0aW9uLlxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdyZW5kZXInLFxuICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7XG4gICAgICB0aGlzLnVzZXIucmVuZGVyKCk7XG4gICAgICB0aGlzLm1lc3NhZ2VGb3JtLnJlbmRlcigpO1xuICAgICAgdGhpcy5zdGFydEludGVydmFsVXBkYXRlKCk7XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIEFwcDtcbn0oKTtcblxud2luZG93LkFwcCA9IEFwcDtcblxuLyoqKi8gfSksXG4vKiA4ICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cbi8vIHJlbW92ZWQgYnkgZXh0cmFjdC10ZXh0LXdlYnBhY2stcGx1Z2luXG5cbi8qKiovIH0pLFxuLyogOSAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG4vLyByZW1vdmVkIGJ5IGV4dHJhY3QtdGV4dC13ZWJwYWNrLXBsdWdpblxuXG4vKioqLyB9KSxcbi8qIDEwICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cbi8vIHJlbW92ZWQgYnkgZXh0cmFjdC10ZXh0LXdlYnBhY2stcGx1Z2luXG5cbi8qKiovIH0pLFxuLyogMTEgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxudmFyIHB1ZyA9IF9fd2VicGFja19yZXF1aXJlX18oMCk7XG5cbmZ1bmN0aW9uIHRlbXBsYXRlKGxvY2Fscykge3ZhciBwdWdfaHRtbCA9IFwiXCIsIHB1Z19taXhpbnMgPSB7fSwgcHVnX2ludGVycDs7dmFyIGxvY2Fsc19mb3Jfd2l0aCA9IChsb2NhbHMgfHwge30pOyhmdW5jdGlvbiAoYXZhdGFyVXJsLCBkYXRlLCBpZCwgaXNPd24sIHRleHQsIHVzZXJuYW1lKSB7cHVnX2h0bWwgPSBwdWdfaHRtbCArIFwiXFx1MDAzQ2xpXCIgKyAocHVnLmF0dHIoXCJjbGFzc1wiLCBwdWcuY2xhc3NlcyhbXCJjaGF0X19tZXNzYWdlXCIsaXNPd24gPyAnY2hhdF9fbWVzc2FnZV9vd24nIDogJyddLCBbZmFsc2UsdHJ1ZV0pLCBmYWxzZSwgdHJ1ZSkrcHVnLmF0dHIoXCJpZFwiLCBpZCwgdHJ1ZSwgdHJ1ZSkpICsgXCJcXHUwMDNFXFx1MDAzQ2RpdiBjbGFzcz1cXFwiY2hhdF9fbWVzc2FnZV9hdmF0YXJcXFwiXFx1MDAzRVxcdTAwM0NpbWdcIiArIChwdWcuYXR0cihcInNyY1wiLCBhdmF0YXJVcmwsIHRydWUsIHRydWUpK3B1Zy5hdHRyKFwiYWx0XCIsIHVzZXJuYW1lLCB0cnVlLCB0cnVlKSkgKyBcIlxcdTAwM0VcXHUwMDNDXFx1MDAyRmRpdlxcdTAwM0VcXHUwMDNDZGl2IGNsYXNzPVxcXCJjaGF0X19tZXNzYWdlX2hlYWRlclxcXCJcXHUwMDNFXFx1MDAzQ3NwYW4gY2xhc3M9XFxcImNoYXRfX21lc3NhZ2VfYXV0aG9yXFxcIlxcdTAwM0VcIiArIChwdWcuZXNjYXBlKG51bGwgPT0gKHB1Z19pbnRlcnAgPSB1c2VybmFtZSkgPyBcIlwiIDogcHVnX2ludGVycCkpICsgXCJcXHUwMDNDXFx1MDAyRnNwYW5cXHUwMDNFXFx1MDAzQ2lucHV0IGNsYXNzPVxcXCJjaGF0X19tZXNzYWdlX2J1dHRvblxcXCIgdHlwZT1cXFwiYnV0dG9uXFxcIiB2YWx1ZT1cXFwieFxcXCJcXHUwMDNFXFx1MDAzQ3NwYW4gY2xhc3M9XFxcImNoYXRfX21lc3NhZ2VfZGF0ZVxcXCJcXHUwMDNFXCIgKyAocHVnLmVzY2FwZShudWxsID09IChwdWdfaW50ZXJwID0gZGF0ZS50b0xvY2FsZVN0cmluZygncnUnLCB7IGhvdXI6ICcyLWRpZ2l0JywgbWludXRlOiAnMi1kaWdpdCcgfSkpID8gXCJcIiA6IHB1Z19pbnRlcnApKSArIFwiXFx1MDAzQ1xcdTAwMkZzcGFuXFx1MDAzRVxcdTAwM0NcXHUwMDJGZGl2XFx1MDAzRVxcdTAwM0NkaXYgY2xhc3M9XFxcImNoYXRfX21lc3NhZ2VfdGV4dFxcXCJcXHUwMDNFXCIgKyAocHVnLmVzY2FwZShudWxsID09IChwdWdfaW50ZXJwID0gdGV4dCkgPyBcIlwiIDogcHVnX2ludGVycCkpICsgXCJcXHUwMDNDXFx1MDAyRmRpdlxcdTAwM0VcXHUwMDNDXFx1MDAyRmxpXFx1MDAzRVwiO30uY2FsbCh0aGlzLFwiYXZhdGFyVXJsXCIgaW4gbG9jYWxzX2Zvcl93aXRoP2xvY2Fsc19mb3Jfd2l0aC5hdmF0YXJVcmw6dHlwZW9mIGF2YXRhclVybCE9PVwidW5kZWZpbmVkXCI/YXZhdGFyVXJsOnVuZGVmaW5lZCxcImRhdGVcIiBpbiBsb2NhbHNfZm9yX3dpdGg/bG9jYWxzX2Zvcl93aXRoLmRhdGU6dHlwZW9mIGRhdGUhPT1cInVuZGVmaW5lZFwiP2RhdGU6dW5kZWZpbmVkLFwiaWRcIiBpbiBsb2NhbHNfZm9yX3dpdGg/bG9jYWxzX2Zvcl93aXRoLmlkOnR5cGVvZiBpZCE9PVwidW5kZWZpbmVkXCI/aWQ6dW5kZWZpbmVkLFwiaXNPd25cIiBpbiBsb2NhbHNfZm9yX3dpdGg/bG9jYWxzX2Zvcl93aXRoLmlzT3duOnR5cGVvZiBpc093biE9PVwidW5kZWZpbmVkXCI/aXNPd246dW5kZWZpbmVkLFwidGV4dFwiIGluIGxvY2Fsc19mb3Jfd2l0aD9sb2NhbHNfZm9yX3dpdGgudGV4dDp0eXBlb2YgdGV4dCE9PVwidW5kZWZpbmVkXCI/dGV4dDp1bmRlZmluZWQsXCJ1c2VybmFtZVwiIGluIGxvY2Fsc19mb3Jfd2l0aD9sb2NhbHNfZm9yX3dpdGgudXNlcm5hbWU6dHlwZW9mIHVzZXJuYW1lIT09XCJ1bmRlZmluZWRcIj91c2VybmFtZTp1bmRlZmluZWQpKTs7cmV0dXJuIHB1Z19odG1sO307XG5tb2R1bGUuZXhwb3J0cyA9IHRlbXBsYXRlO1xuXG4vKioqLyB9KSxcbi8qIDEyICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cbnZhciBwdWcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuXG5mdW5jdGlvbiB0ZW1wbGF0ZShsb2NhbHMpIHt2YXIgcHVnX2h0bWwgPSBcIlwiLCBwdWdfbWl4aW5zID0ge30sIHB1Z19pbnRlcnA7cHVnX2h0bWwgPSBwdWdfaHRtbCArIFwiXFx1MDAzQ2Zvcm0gY2xhc3M9XFxcIm1lc3NhZ2UtZm9ybVxcXCJcXHUwMDNFXFx1MDAzQ3RleHRhcmVhIGNsYXNzPVxcXCJtZXNzYWdlLWZvcm1fX2lucHV0XFxcIiBuYW1lPVxcXCJtZXNzYWdlXFxcIiBwbGFjZWhvbGRlcj1cXFwi0KHQvtC+0LHRidC10L3QuNC1Li4uXFxcIlxcdTAwM0VcXHUwMDNDXFx1MDAyRnRleHRhcmVhXFx1MDAzRVxcdTAwM0NpbnB1dCBjbGFzcz1cXFwiYnV0dG9uIG1lc3NhZ2UtZm9ybV9fYnV0dG9uIGlucHV0X2J1dHRvblxcXCIgdHlwZT1cXFwic3VibWl0XFxcIiB2YWx1ZT1cXFwiJmd0O1xcXCJcXHUwMDNFXFx1MDAzQ1xcdTAwMkZmb3JtXFx1MDAzRVwiOztyZXR1cm4gcHVnX2h0bWw7fTtcbm1vZHVsZS5leHBvcnRzID0gdGVtcGxhdGU7XG5cbi8qKiovIH0pLFxuLyogMTMgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxudmFyIHB1ZyA9IF9fd2VicGFja19yZXF1aXJlX18oMCk7XG5cbmZ1bmN0aW9uIHRlbXBsYXRlKGxvY2Fscykge3ZhciBwdWdfaHRtbCA9IFwiXCIsIHB1Z19taXhpbnMgPSB7fSwgcHVnX2ludGVycDs7dmFyIGxvY2Fsc19mb3Jfd2l0aCA9IChsb2NhbHMgfHwge30pOyhmdW5jdGlvbiAoYXZhdGFyVXJsLCB1c2VybmFtZSkge3B1Z19odG1sID0gcHVnX2h0bWwgKyBcIlxcdTAwM0NkaXYgY2xhc3M9XFxcInVzZXJcXFwiXFx1MDAzRVxcdTAwM0NoMSBjbGFzcz1cXFwidXNlcl9fdXNlcm5hbWUgdG9nZ2xlIHRvZ2dsZWRcXFwiIGRhdGEtdG9nZ2xlPVxcXCJ1c2VybmFtZVxcXCJcXHUwMDNFXCIgKyAocHVnLmVzY2FwZShudWxsID09IChwdWdfaW50ZXJwID0gdXNlcm5hbWUpID8gXCJcIiA6IHB1Z19pbnRlcnApKSArIFwiXFx1MDAzQ1xcdTAwMkZoMVxcdTAwM0VcXHUwMDNDZm9ybSBjbGFzcz1cXFwidXNlci1mb3JtIHVzZXItZm9ybV9fdXNlcm5hbWUgaGlkZGVuXFxcIiBkYXRhLWFjdGlvbj1cXFwic2V0VXNlcm5hbWVcXFwiXFx1MDAzRVxcdTAwM0NpbnB1dCBjbGFzcz1cXFwidXNlcl9faW5wdXQgdXNlcl9faW5wdXRfdXNlcm5hbWVcXFwiIG5hbWU9XFxcInVzZXJuYW1lXFxcIiBwbGFjZWhvbGRlcj1cXFwi0KPQutCw0LbQuNGC0LUg0LjQvNGPXFxcIlxcdTAwM0VcXHUwMDNDaW5wdXQgY2xhc3M9XFxcImJ1dHRvbiB1c2VyX19pbnB1dF9idXR0b24gaW5wdXRfYnV0dG9uXFxcIiB0eXBlPVxcXCJzdWJtaXRcXFwiIHZhbHVlPVxcXCImZ3Q7XFxcIlxcdTAwM0VcXHUwMDNDXFx1MDAyRmZvcm1cXHUwMDNFXFx1MDAzQ2Zvcm0gY2xhc3M9XFxcInVzZXItZm9ybSB1c2VyLWZvcm1fX2F2YXRhciBoaWRkZW5cXFwiIGRhdGEtYWN0aW9uPVxcXCJzZXRBdmF0YXJcXFwiXFx1MDAzRVxcdTAwM0NpbnB1dCBjbGFzcz1cXFwidXNlcl9faW5wdXQgdXNlcl9faW5wdXRfYXZhdGFyXFxcIiBuYW1lPVxcXCJhdmF0YXJVcmxcXFwiIHBsYWNlaG9sZGVyPVxcXCJVUkwg0LDQstCw0YLQsNGA0YtcXFwiXFx1MDAzRVxcdTAwM0NpbnB1dCBjbGFzcz1cXFwiYnV0dG9uIHVzZXJfX2lucHV0X2J1dHRvbiBpbnB1dF9idXR0b25cXFwiIHR5cGU9XFxcInN1Ym1pdFxcXCIgdmFsdWU9XFxcIiZndDtcXFwiXFx1MDAzRVxcdTAwM0NcXHUwMDJGZm9ybVxcdTAwM0VcXHUwMDNDZmlndXJlIGNsYXNzPVxcXCJ1c2VyX19hdmF0YXJcXFwiXFx1MDAzRVxcdTAwM0NpbWdcIiArIChcIiBjbGFzcz1cXFwidG9nZ2xlXFxcIlwiK1wiIGRhdGEtdG9nZ2xlPVxcXCJhdmF0YXJcXFwiXCIrcHVnLmF0dHIoXCJzcmNcIiwgYXZhdGFyVXJsLCB0cnVlLCB0cnVlKStwdWcuYXR0cihcImFsdFwiLCB1c2VybmFtZSwgdHJ1ZSwgdHJ1ZSkpICsgXCJcXHUwMDNFXFx1MDAzQ1xcdTAwMkZmaWd1cmVcXHUwMDNFXFx1MDAzQ1xcdTAwMkZkaXZcXHUwMDNFXCI7fS5jYWxsKHRoaXMsXCJhdmF0YXJVcmxcIiBpbiBsb2NhbHNfZm9yX3dpdGg/bG9jYWxzX2Zvcl93aXRoLmF2YXRhclVybDp0eXBlb2YgYXZhdGFyVXJsIT09XCJ1bmRlZmluZWRcIj9hdmF0YXJVcmw6dW5kZWZpbmVkLFwidXNlcm5hbWVcIiBpbiBsb2NhbHNfZm9yX3dpdGg/bG9jYWxzX2Zvcl93aXRoLnVzZXJuYW1lOnR5cGVvZiB1c2VybmFtZSE9PVwidW5kZWZpbmVkXCI/dXNlcm5hbWU6dW5kZWZpbmVkKSk7O3JldHVybiBwdWdfaHRtbDt9O1xubW9kdWxlLmV4cG9ydHMgPSB0ZW1wbGF0ZTtcblxuLyoqKi8gfSksXG4vKiAxNCAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG4vKiAoaWdub3JlZCkgKi9cblxuLyoqKi8gfSlcbi8qKioqKiovIF0pO1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBhc3NldHMvYnVuZGxlLmpzIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gaWRlbnRpdHkgZnVuY3Rpb24gZm9yIGNhbGxpbmcgaGFybW9ueSBpbXBvcnRzIHdpdGggdGhlIGNvcnJlY3QgY29udGV4dFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5pID0gZnVuY3Rpb24odmFsdWUpIHsgcmV0dXJuIHZhbHVlOyB9O1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHtcbiBcdFx0XHRcdGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4gXHRcdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuIFx0XHRcdFx0Z2V0OiBnZXR0ZXJcbiBcdFx0XHR9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSA3KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyB3ZWJwYWNrL2Jvb3RzdHJhcCAyZGRkMzg2ZmRmMzc2NmVlNjE1YyIsIid1c2Ugc3RyaWN0JztcblxudmFyIHB1Z19oYXNfb3duX3Byb3BlcnR5ID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTtcblxuLyoqXG4gKiBNZXJnZSB0d28gYXR0cmlidXRlIG9iamVjdHMgZ2l2aW5nIHByZWNlZGVuY2VcbiAqIHRvIHZhbHVlcyBpbiBvYmplY3QgYGJgLiBDbGFzc2VzIGFyZSBzcGVjaWFsLWNhc2VkXG4gKiBhbGxvd2luZyBmb3IgYXJyYXlzIGFuZCBtZXJnaW5nL2pvaW5pbmcgYXBwcm9wcmlhdGVseVxuICogcmVzdWx0aW5nIGluIGEgc3RyaW5nLlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBhXG4gKiBAcGFyYW0ge09iamVjdH0gYlxuICogQHJldHVybiB7T2JqZWN0fSBhXG4gKiBAYXBpIHByaXZhdGVcbiAqL1xuXG5leHBvcnRzLm1lcmdlID0gcHVnX21lcmdlO1xuZnVuY3Rpb24gcHVnX21lcmdlKGEsIGIpIHtcbiAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEpIHtcbiAgICB2YXIgYXR0cnMgPSBhWzBdO1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYS5sZW5ndGg7IGkrKykge1xuICAgICAgYXR0cnMgPSBwdWdfbWVyZ2UoYXR0cnMsIGFbaV0pO1xuICAgIH1cbiAgICByZXR1cm4gYXR0cnM7XG4gIH1cblxuICBmb3IgKHZhciBrZXkgaW4gYikge1xuICAgIGlmIChrZXkgPT09ICdjbGFzcycpIHtcbiAgICAgIHZhciB2YWxBID0gYVtrZXldIHx8IFtdO1xuICAgICAgYVtrZXldID0gKEFycmF5LmlzQXJyYXkodmFsQSkgPyB2YWxBIDogW3ZhbEFdKS5jb25jYXQoYltrZXldIHx8IFtdKTtcbiAgICB9IGVsc2UgaWYgKGtleSA9PT0gJ3N0eWxlJykge1xuICAgICAgdmFyIHZhbEEgPSBwdWdfc3R5bGUoYVtrZXldKTtcbiAgICAgIHZhciB2YWxCID0gcHVnX3N0eWxlKGJba2V5XSk7XG4gICAgICBhW2tleV0gPSB2YWxBICsgdmFsQjtcbiAgICB9IGVsc2Uge1xuICAgICAgYVtrZXldID0gYltrZXldO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBhO1xufTtcblxuLyoqXG4gKiBQcm9jZXNzIGFycmF5LCBvYmplY3QsIG9yIHN0cmluZyBhcyBhIHN0cmluZyBvZiBjbGFzc2VzIGRlbGltaXRlZCBieSBhIHNwYWNlLlxuICpcbiAqIElmIGB2YWxgIGlzIGFuIGFycmF5LCBhbGwgbWVtYmVycyBvZiBpdCBhbmQgaXRzIHN1YmFycmF5cyBhcmUgY291bnRlZCBhc1xuICogY2xhc3Nlcy4gSWYgYGVzY2FwaW5nYCBpcyBhbiBhcnJheSwgdGhlbiB3aGV0aGVyIG9yIG5vdCB0aGUgaXRlbSBpbiBgdmFsYCBpc1xuICogZXNjYXBlZCBkZXBlbmRzIG9uIHRoZSBjb3JyZXNwb25kaW5nIGl0ZW0gaW4gYGVzY2FwaW5nYC4gSWYgYGVzY2FwaW5nYCBpc1xuICogbm90IGFuIGFycmF5LCBubyBlc2NhcGluZyBpcyBkb25lLlxuICpcbiAqIElmIGB2YWxgIGlzIGFuIG9iamVjdCwgYWxsIHRoZSBrZXlzIHdob3NlIHZhbHVlIGlzIHRydXRoeSBhcmUgY291bnRlZCBhc1xuICogY2xhc3Nlcy4gTm8gZXNjYXBpbmcgaXMgZG9uZS5cbiAqXG4gKiBJZiBgdmFsYCBpcyBhIHN0cmluZywgaXQgaXMgY291bnRlZCBhcyBhIGNsYXNzLiBObyBlc2NhcGluZyBpcyBkb25lLlxuICpcbiAqIEBwYXJhbSB7KEFycmF5LjxzdHJpbmc+fE9iamVjdC48c3RyaW5nLCBib29sZWFuPnxzdHJpbmcpfSB2YWxcbiAqIEBwYXJhbSB7P0FycmF5LjxzdHJpbmc+fSBlc2NhcGluZ1xuICogQHJldHVybiB7U3RyaW5nfVxuICovXG5leHBvcnRzLmNsYXNzZXMgPSBwdWdfY2xhc3NlcztcbmZ1bmN0aW9uIHB1Z19jbGFzc2VzX2FycmF5KHZhbCwgZXNjYXBpbmcpIHtcbiAgdmFyIGNsYXNzU3RyaW5nID0gJycsIGNsYXNzTmFtZSwgcGFkZGluZyA9ICcnLCBlc2NhcGVFbmFibGVkID0gQXJyYXkuaXNBcnJheShlc2NhcGluZyk7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgdmFsLmxlbmd0aDsgaSsrKSB7XG4gICAgY2xhc3NOYW1lID0gcHVnX2NsYXNzZXModmFsW2ldKTtcbiAgICBpZiAoIWNsYXNzTmFtZSkgY29udGludWU7XG4gICAgZXNjYXBlRW5hYmxlZCAmJiBlc2NhcGluZ1tpXSAmJiAoY2xhc3NOYW1lID0gcHVnX2VzY2FwZShjbGFzc05hbWUpKTtcbiAgICBjbGFzc1N0cmluZyA9IGNsYXNzU3RyaW5nICsgcGFkZGluZyArIGNsYXNzTmFtZTtcbiAgICBwYWRkaW5nID0gJyAnO1xuICB9XG4gIHJldHVybiBjbGFzc1N0cmluZztcbn1cbmZ1bmN0aW9uIHB1Z19jbGFzc2VzX29iamVjdCh2YWwpIHtcbiAgdmFyIGNsYXNzU3RyaW5nID0gJycsIHBhZGRpbmcgPSAnJztcbiAgZm9yICh2YXIga2V5IGluIHZhbCkge1xuICAgIGlmIChrZXkgJiYgdmFsW2tleV0gJiYgcHVnX2hhc19vd25fcHJvcGVydHkuY2FsbCh2YWwsIGtleSkpIHtcbiAgICAgIGNsYXNzU3RyaW5nID0gY2xhc3NTdHJpbmcgKyBwYWRkaW5nICsga2V5O1xuICAgICAgcGFkZGluZyA9ICcgJztcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGNsYXNzU3RyaW5nO1xufVxuZnVuY3Rpb24gcHVnX2NsYXNzZXModmFsLCBlc2NhcGluZykge1xuICBpZiAoQXJyYXkuaXNBcnJheSh2YWwpKSB7XG4gICAgcmV0dXJuIHB1Z19jbGFzc2VzX2FycmF5KHZhbCwgZXNjYXBpbmcpO1xuICB9IGVsc2UgaWYgKHZhbCAmJiB0eXBlb2YgdmFsID09PSAnb2JqZWN0Jykge1xuICAgIHJldHVybiBwdWdfY2xhc3Nlc19vYmplY3QodmFsKTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gdmFsIHx8ICcnO1xuICB9XG59XG5cbi8qKlxuICogQ29udmVydCBvYmplY3Qgb3Igc3RyaW5nIHRvIGEgc3RyaW5nIG9mIENTUyBzdHlsZXMgZGVsaW1pdGVkIGJ5IGEgc2VtaWNvbG9uLlxuICpcbiAqIEBwYXJhbSB7KE9iamVjdC48c3RyaW5nLCBzdHJpbmc+fHN0cmluZyl9IHZhbFxuICogQHJldHVybiB7U3RyaW5nfVxuICovXG5cbmV4cG9ydHMuc3R5bGUgPSBwdWdfc3R5bGU7XG5mdW5jdGlvbiBwdWdfc3R5bGUodmFsKSB7XG4gIGlmICghdmFsKSByZXR1cm4gJyc7XG4gIGlmICh0eXBlb2YgdmFsID09PSAnb2JqZWN0Jykge1xuICAgIHZhciBvdXQgPSAnJztcbiAgICBmb3IgKHZhciBzdHlsZSBpbiB2YWwpIHtcbiAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBlbHNlICovXG4gICAgICBpZiAocHVnX2hhc19vd25fcHJvcGVydHkuY2FsbCh2YWwsIHN0eWxlKSkge1xuICAgICAgICBvdXQgPSBvdXQgKyBzdHlsZSArICc6JyArIHZhbFtzdHlsZV0gKyAnOyc7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvdXQ7XG4gIH0gZWxzZSB7XG4gICAgdmFsICs9ICcnO1xuICAgIGlmICh2YWxbdmFsLmxlbmd0aCAtIDFdICE9PSAnOycpIFxuICAgICAgcmV0dXJuIHZhbCArICc7JztcbiAgICByZXR1cm4gdmFsO1xuICB9XG59O1xuXG4vKipcbiAqIFJlbmRlciB0aGUgZ2l2ZW4gYXR0cmlidXRlLlxuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSBrZXlcbiAqIEBwYXJhbSB7U3RyaW5nfSB2YWxcbiAqIEBwYXJhbSB7Qm9vbGVhbn0gZXNjYXBlZFxuICogQHBhcmFtIHtCb29sZWFufSB0ZXJzZVxuICogQHJldHVybiB7U3RyaW5nfVxuICovXG5leHBvcnRzLmF0dHIgPSBwdWdfYXR0cjtcbmZ1bmN0aW9uIHB1Z19hdHRyKGtleSwgdmFsLCBlc2NhcGVkLCB0ZXJzZSkge1xuICBpZiAodmFsID09PSBmYWxzZSB8fCB2YWwgPT0gbnVsbCB8fCAhdmFsICYmIChrZXkgPT09ICdjbGFzcycgfHwga2V5ID09PSAnc3R5bGUnKSkge1xuICAgIHJldHVybiAnJztcbiAgfVxuICBpZiAodmFsID09PSB0cnVlKSB7XG4gICAgcmV0dXJuICcgJyArICh0ZXJzZSA/IGtleSA6IGtleSArICc9XCInICsga2V5ICsgJ1wiJyk7XG4gIH1cbiAgaWYgKHR5cGVvZiB2YWwudG9KU09OID09PSAnZnVuY3Rpb24nKSB7XG4gICAgdmFsID0gdmFsLnRvSlNPTigpO1xuICB9XG4gIGlmICh0eXBlb2YgdmFsICE9PSAnc3RyaW5nJykge1xuICAgIHZhbCA9IEpTT04uc3RyaW5naWZ5KHZhbCk7XG4gICAgaWYgKCFlc2NhcGVkICYmIHZhbC5pbmRleE9mKCdcIicpICE9PSAtMSkge1xuICAgICAgcmV0dXJuICcgJyArIGtleSArICc9XFwnJyArIHZhbC5yZXBsYWNlKC8nL2csICcmIzM5OycpICsgJ1xcJyc7XG4gICAgfVxuICB9XG4gIGlmIChlc2NhcGVkKSB2YWwgPSBwdWdfZXNjYXBlKHZhbCk7XG4gIHJldHVybiAnICcgKyBrZXkgKyAnPVwiJyArIHZhbCArICdcIic7XG59O1xuXG4vKipcbiAqIFJlbmRlciB0aGUgZ2l2ZW4gYXR0cmlidXRlcyBvYmplY3QuXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IG9ialxuICogQHBhcmFtIHtPYmplY3R9IHRlcnNlIHdoZXRoZXIgdG8gdXNlIEhUTUw1IHRlcnNlIGJvb2xlYW4gYXR0cmlidXRlc1xuICogQHJldHVybiB7U3RyaW5nfVxuICovXG5leHBvcnRzLmF0dHJzID0gcHVnX2F0dHJzO1xuZnVuY3Rpb24gcHVnX2F0dHJzKG9iaiwgdGVyc2Upe1xuICB2YXIgYXR0cnMgPSAnJztcblxuICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG4gICAgaWYgKHB1Z19oYXNfb3duX3Byb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7XG4gICAgICB2YXIgdmFsID0gb2JqW2tleV07XG5cbiAgICAgIGlmICgnY2xhc3MnID09PSBrZXkpIHtcbiAgICAgICAgdmFsID0gcHVnX2NsYXNzZXModmFsKTtcbiAgICAgICAgYXR0cnMgPSBwdWdfYXR0cihrZXksIHZhbCwgZmFsc2UsIHRlcnNlKSArIGF0dHJzO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIGlmICgnc3R5bGUnID09PSBrZXkpIHtcbiAgICAgICAgdmFsID0gcHVnX3N0eWxlKHZhbCk7XG4gICAgICB9XG4gICAgICBhdHRycyArPSBwdWdfYXR0cihrZXksIHZhbCwgZmFsc2UsIHRlcnNlKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gYXR0cnM7XG59O1xuXG4vKipcbiAqIEVzY2FwZSB0aGUgZ2l2ZW4gc3RyaW5nIG9mIGBodG1sYC5cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gaHRtbFxuICogQHJldHVybiB7U3RyaW5nfVxuICogQGFwaSBwcml2YXRlXG4gKi9cblxudmFyIHB1Z19tYXRjaF9odG1sID0gL1tcIiY8Pl0vO1xuZXhwb3J0cy5lc2NhcGUgPSBwdWdfZXNjYXBlO1xuZnVuY3Rpb24gcHVnX2VzY2FwZShfaHRtbCl7XG4gIHZhciBodG1sID0gJycgKyBfaHRtbDtcbiAgdmFyIHJlZ2V4UmVzdWx0ID0gcHVnX21hdGNoX2h0bWwuZXhlYyhodG1sKTtcbiAgaWYgKCFyZWdleFJlc3VsdCkgcmV0dXJuIF9odG1sO1xuXG4gIHZhciByZXN1bHQgPSAnJztcbiAgdmFyIGksIGxhc3RJbmRleCwgZXNjYXBlO1xuICBmb3IgKGkgPSByZWdleFJlc3VsdC5pbmRleCwgbGFzdEluZGV4ID0gMDsgaSA8IGh0bWwubGVuZ3RoOyBpKyspIHtcbiAgICBzd2l0Y2ggKGh0bWwuY2hhckNvZGVBdChpKSkge1xuICAgICAgY2FzZSAzNDogZXNjYXBlID0gJyZxdW90Oyc7IGJyZWFrO1xuICAgICAgY2FzZSAzODogZXNjYXBlID0gJyZhbXA7JzsgYnJlYWs7XG4gICAgICBjYXNlIDYwOiBlc2NhcGUgPSAnJmx0Oyc7IGJyZWFrO1xuICAgICAgY2FzZSA2MjogZXNjYXBlID0gJyZndDsnOyBicmVhaztcbiAgICAgIGRlZmF1bHQ6IGNvbnRpbnVlO1xuICAgIH1cbiAgICBpZiAobGFzdEluZGV4ICE9PSBpKSByZXN1bHQgKz0gaHRtbC5zdWJzdHJpbmcobGFzdEluZGV4LCBpKTtcbiAgICBsYXN0SW5kZXggPSBpICsgMTtcbiAgICByZXN1bHQgKz0gZXNjYXBlO1xuICB9XG4gIGlmIChsYXN0SW5kZXggIT09IGkpIHJldHVybiByZXN1bHQgKyBodG1sLnN1YnN0cmluZyhsYXN0SW5kZXgsIGkpO1xuICBlbHNlIHJldHVybiByZXN1bHQ7XG59O1xuXG4vKipcbiAqIFJlLXRocm93IHRoZSBnaXZlbiBgZXJyYCBpbiBjb250ZXh0IHRvIHRoZVxuICogdGhlIHB1ZyBpbiBgZmlsZW5hbWVgIGF0IHRoZSBnaXZlbiBgbGluZW5vYC5cbiAqXG4gKiBAcGFyYW0ge0Vycm9yfSBlcnJcbiAqIEBwYXJhbSB7U3RyaW5nfSBmaWxlbmFtZVxuICogQHBhcmFtIHtTdHJpbmd9IGxpbmVub1xuICogQHBhcmFtIHtTdHJpbmd9IHN0ciBvcmlnaW5hbCBzb3VyY2VcbiAqIEBhcGkgcHJpdmF0ZVxuICovXG5cbmV4cG9ydHMucmV0aHJvdyA9IHB1Z19yZXRocm93O1xuZnVuY3Rpb24gcHVnX3JldGhyb3coZXJyLCBmaWxlbmFtZSwgbGluZW5vLCBzdHIpe1xuICBpZiAoIShlcnIgaW5zdGFuY2VvZiBFcnJvcikpIHRocm93IGVycjtcbiAgaWYgKCh0eXBlb2Ygd2luZG93ICE9ICd1bmRlZmluZWQnIHx8ICFmaWxlbmFtZSkgJiYgIXN0cikge1xuICAgIGVyci5tZXNzYWdlICs9ICcgb24gbGluZSAnICsgbGluZW5vO1xuICAgIHRocm93IGVycjtcbiAgfVxuICB0cnkge1xuICAgIHN0ciA9IHN0ciB8fCByZXF1aXJlKCdmcycpLnJlYWRGaWxlU3luYyhmaWxlbmFtZSwgJ3V0ZjgnKVxuICB9IGNhdGNoIChleCkge1xuICAgIHB1Z19yZXRocm93KGVyciwgbnVsbCwgbGluZW5vKVxuICB9XG4gIHZhciBjb250ZXh0ID0gM1xuICAgICwgbGluZXMgPSBzdHIuc3BsaXQoJ1xcbicpXG4gICAgLCBzdGFydCA9IE1hdGgubWF4KGxpbmVubyAtIGNvbnRleHQsIDApXG4gICAgLCBlbmQgPSBNYXRoLm1pbihsaW5lcy5sZW5ndGgsIGxpbmVubyArIGNvbnRleHQpO1xuXG4gIC8vIEVycm9yIGNvbnRleHRcbiAgdmFyIGNvbnRleHQgPSBsaW5lcy5zbGljZShzdGFydCwgZW5kKS5tYXAoZnVuY3Rpb24obGluZSwgaSl7XG4gICAgdmFyIGN1cnIgPSBpICsgc3RhcnQgKyAxO1xuICAgIHJldHVybiAoY3VyciA9PSBsaW5lbm8gPyAnICA+ICcgOiAnICAgICcpXG4gICAgICArIGN1cnJcbiAgICAgICsgJ3wgJ1xuICAgICAgKyBsaW5lO1xuICB9KS5qb2luKCdcXG4nKTtcblxuICAvLyBBbHRlciBleGNlcHRpb24gbWVzc2FnZVxuICBlcnIucGF0aCA9IGZpbGVuYW1lO1xuICBlcnIubWVzc2FnZSA9IChmaWxlbmFtZSB8fCAnUHVnJykgKyAnOicgKyBsaW5lbm9cbiAgICArICdcXG4nICsgY29udGV4dCArICdcXG5cXG4nICsgZXJyLm1lc3NhZ2U7XG4gIHRocm93IGVycjtcbn07XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vcHVnLXJ1bnRpbWUvaW5kZXguanNcbi8vIG1vZHVsZSBpZCA9IDBcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0IHN0eWxlcyBmcm9tICcuL2NoYXQuY3NzJztcbmltcG9ydCBtZXNzYWdlVGVtcGxhdGUgZnJvbSAnLi9tZXNzYWdlLnRtcGwucHVnJztcblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBDaGF0TWVzc2FnZVxuICogQHByb3BlcnR5IHtzdHJpbmd9IHVzZXJJZFxuICogQHByb3BlcnR5IHtzdHJpbmd9IHVzZXJuYW1lXG4gKiBAcHJvcGVydHkge3N0cmluZ30gYXZhdGFyVXJsXG4gKiBAcHJvcGVydHkge0RhdGV9IGRhdGVcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBtZXNzYWdlXG4gKi9cblxuY2xhc3MgQ2hhdCB7XG5cbiAgLyoqXG4gICAqIENyZWF0ZSBjb250YWluZXIgZWxlbWVudCwgaW5pdCBldmVudHMuXG4gICAqIEBwYXJhbSB7SHRtbEVsZW1lbnR9IGVsXG4gICAqIEBwYXJhbSB7VXNlcn0gY3VycmVudFVzZXJcbiAgICovXG4gIGNvbnN0cnVjdG9yKHsgZWwsIGN1cnJlbnRVc2VyIH0pIHtcbiAgICB0aGlzLmVsID0gZWw7XG4gICAgdGhpcy5jdXJyZW50VXNlciA9IGN1cnJlbnRVc2VyO1xuICAgIHRoaXMuY29udGFpbmVyRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd1bCcpO1xuICAgIHRoaXMuY29udGFpbmVyRWwuY2xhc3NOYW1lID0gJ2NoYXRfX21lc3NhZ2VzJztcbiAgICB0aGlzLmVsLmFwcGVuZENoaWxkKHRoaXMuY29udGFpbmVyRWwpO1xuICAgIHRoaXMucHJvY2Vzc2VkTWVzc2FnZXMgPSB7fTtcbiAgICB0aGlzLmluaXRFdmVudHMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXQgZXZlbnQgaGFuZGxlci5cbiAgICogQHBhcmFtIHtldmVudH0gZXZlbnRcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gaGFuZGxlclxuICAgKi9cbiAgb24oZXZlbnQsIGhhbmRsZXIpIHtcbiAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZXIpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSBleGlzdHMgbWVzc2FnZXMgb24gdGhlIGNoYXQuXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBtZXNzYWdlcyB0aGUge0NoYXRNZXNzYWdlfSBvYmplY3QgKG9iamVjdCBrZXkgPT09IG1lc3NhZ2VJZCkuXG4gICAqL1xuICB1cGRhdGVNZXNzYWdlcyhtZXNzYWdlcykge1xuICAgIGNvbnN0IGlkcyA9IE9iamVjdC5rZXlzKG1lc3NhZ2VzKTtcbiAgICBsZXQgbGFzdEV4aXN0TWVzc2FnZUlkO1xuICAgIGlkcy5mb3JFYWNoKChtZXNzYWdlSWQpID0+IHtcbiAgICAgIGlmICh0aGlzLnByb2Nlc3NlZE1lc3NhZ2VzW21lc3NhZ2VJZF0pIHtcbiAgICAgICAgbGFzdEV4aXN0TWVzc2FnZUlkID0gbWVzc2FnZUlkO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5pbnNlcnRNZXNzYWdlKG1lc3NhZ2VJZCwgbWVzc2FnZXNbbWVzc2FnZUlkXSwgbGFzdEV4aXN0TWVzc2FnZUlkKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICB0aGlzLnNjcm9sbFRvQm90dG9tKCk7XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlIG1lc3NhZ2UgZnJvbSBhIGNoYXQuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlSWRcbiAgICovXG4gIGRlbGV0ZU1lc3NhZ2UobWVzc2FnZUlkKSB7XG4gICAgaWYgKCF0aGlzLnByb2Nlc3NlZE1lc3NhZ2VzW21lc3NhZ2VJZF0pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgbWVzc2FnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG1lc3NhZ2VJZCk7XG4gICAgaWYgKCFtZXNzYWdlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuY29udGFpbmVyRWwucmVtb3ZlQ2hpbGQobWVzc2FnZSk7XG4gICAgZGVsZXRlICh0aGlzLnByb2Nlc3NlZE1lc3NhZ2VzW21lc3NhZ2VJZF0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEluc2VydCBhIG5ldyBtZXNzYWdlIGFmdGVyIGRlc2NyaWJlZCBtZXNzYWdlIChpZiBwcmVzZW50KSBvciBhdCB0aGUgZW5kIG90aGVyd2lzZS5cbiAgICogQHBhcmFtIHtzdHJpbmd9IG1lc3NhZ2VJZCBUaGUgbWVzc2FnZSBJRC5cbiAgICogQHBhcmFtIHtDaGF0TWVzc2FnZX0gbWVzc2FnZSBUaGUgbWVzc2FnZS5cbiAgICogQHBhcmFtIHtudW1iZXJ9IGFmdGVyTWVzc2FnZUlkXG4gICAqL1xuICBpbnNlcnRNZXNzYWdlKG1lc3NhZ2VJZCwgbWVzc2FnZSwgYWZ0ZXJNZXNzYWdlSWQgPSAwKSB7XG4gICAgdGhpcy5wcm9jZXNzZWRNZXNzYWdlc1ttZXNzYWdlSWRdID0gdHJ1ZTtcbiAgICBpZiAoYWZ0ZXJNZXNzYWdlSWQgJiYgdGhpcy5wcm9jZXNzZWRNZXNzYWdlc1thZnRlck1lc3NhZ2VJZF0pIHtcbiAgICAgIGNvbnN0IGFmdGVyRWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChhZnRlck1lc3NhZ2VJZCk7XG4gICAgICBpZiAoYWZ0ZXJFbCkge1xuICAgICAgICBhZnRlckVsLmluc2VydEFkamFjZW50SFRNTCgnYWZ0ZXJFbmQnLCB0aGlzLnJlbmRlckl0ZW0obWVzc2FnZUlkLCBtZXNzYWdlKSk7XG4gICAgICAgIHRoaXMucHJvY2Vzc2VkTWVzc2FnZXNbYWZ0ZXJNZXNzYWdlSWRdID0gdHJ1ZTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLmNvbnRhaW5lckVsLmluc2VydEFkamFjZW50SFRNTCgnYmVmb3JlRW5kJywgdGhpcy5yZW5kZXJJdGVtKG1lc3NhZ2VJZCwgbWVzc2FnZSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEluaXQgdGhlIG1lc3NhZ2UgZXZlbnRzLlxuICAgKi9cbiAgaW5pdEV2ZW50cygpIHtcbiAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5jbGljay5iaW5kKHRoaXMpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGF0IG1lc3NhZ2UgY2xpY2sgaGFuZGxlclxuICAgKiBAcGFyYW0ge0V2ZW50fSBldmVudFxuICAgKi9cbiAgY2xpY2soZXZlbnQpIHtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGlmIChldmVudC50YXJnZXQudHlwZSAhPT0gJ2J1dHRvbicpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgbWVzc2FnZUl0ZW0gPSBldmVudC50YXJnZXQuY2xvc2VzdCgnbGkuY2hhdF9fbWVzc2FnZScpO1xuICAgIGlmICghbWVzc2FnZUl0ZW0gfHwgIW1lc3NhZ2VJdGVtLmlkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IGRlbGV0ZUV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KCdtZXNzYWdlRGVsZXRlJywgeyBkZXRhaWw6IHsgbWVzc2FnZUlkOiBtZXNzYWdlSXRlbS5pZCB9IH0pO1xuICAgIHRoaXMuZWwuZGlzcGF0Y2hFdmVudChkZWxldGVFdmVudCk7XG4gIH1cblxuICAvKipcbiAgICogU2Nyb2xsIGNoYXQgd2luZG93IHRvIGJvdHRvbS5cbiAgICovXG4gIHNjcm9sbFRvQm90dG9tKCkge1xuICAgIHRoaXMuZWwuc2Nyb2xsVG9wID0gdGhpcy5lbC5zY3JvbGxIZWlnaHQ7XG4gIH1cblxuICAvKipcbiAgICogUmVuZGVyIHRoZSBtZXNzYWdlIGJhc2VkIG9uIHRlbXBsYXRlLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZUlkIFRoZSBtZXNzYWdlIElELlxuICAgKiBAcGFyYW0ge0NoYXRNZXNzYWdlfSBtZXNzYWdlIFRoZSBtZXNzYWdlLlxuICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgKi9cbiAgcmVuZGVySXRlbShtZXNzYWdlSWQsIG1lc3NhZ2UpIHtcbiAgICByZXR1cm4gbWVzc2FnZVRlbXBsYXRlKHtcbiAgICAgIGlkOiBtZXNzYWdlSWQsXG4gICAgICBpc093bjogdGhpcy5jdXJyZW50VXNlci51c2VySWQgPT09IG1lc3NhZ2UudXNlcklkLFxuICAgICAgdXNlcm5hbWU6IG1lc3NhZ2UudXNlcm5hbWUgfHwgdGhpcy5jdXJyZW50VXNlci5kZWZhdWx0VXNlcm5hbWUsXG4gICAgICBhdmF0YXJVcmw6IG1lc3NhZ2UuYXZhdGFyVXJsIHx8IHRoaXMuY3VycmVudFVzZXIuZGVmYXVsdEF2YXRhclVybCxcbiAgICAgIGRhdGU6IG5ldyBEYXRlKG1lc3NhZ2UuZGF0ZSksXG4gICAgICB0ZXh0OiBtZXNzYWdlLm1lc3NhZ2UsXG4gICAgfSk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgQ2hhdDtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL2NvbXBvbmVudHMvY2hhdC9jaGF0LmpzIiwiaW1wb3J0IHN0eWxlcyBmcm9tICcuL21lc3NhZ2VGb3JtLmNzcyc7XG5pbXBvcnQgZm9ybVRlbXBsYXRlIGZyb20gJy4vZm9ybS50bXBsLnB1Zyc7XG5cbmNsYXNzIE1lc3NhZ2VGb3JtIHtcblxuICBjb25zdHJ1Y3Rvcih7IGVsIH0pIHtcbiAgICB0aGlzLmVsID0gZWw7XG4gICAgdGhpcy5pbml0RXZlbnRzKCk7XG4gIH1cblxuICAvKipcbiAgICogSW5pdCB0aGUgbWVzc2FnZSBldmVudHMuXG4gICAqL1xuICBpbml0RXZlbnRzKCkge1xuICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgdGhpcy5tZXNzYWdlU3VibWl0LmJpbmQodGhpcykpO1xuICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMua2V5RG93bi5iaW5kKHRoaXMpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXQgZXZlbnQgaGFuZGxlci5cbiAgICovXG4gIG9uKGV2ZW50LCBoYW5kbGVyKSB7XG4gICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgc3VibWl0dGVkIG1lc3NhZ2UgYW5kIHRoZW4gY2xlYXIgdGhlIGVsZW1lbnQgdmFsdWUuXG4gICAqIEByZXR1cm5zIHtzdHJpbmd9XG4gICAqL1xuICBnZXRNZXNzYWdlKCkge1xuICAgIGlmICghdGhpcy5pbnB1dEVsKSB7XG4gICAgICB0aGlzLmlucHV0RWwgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoJ1tuYW1lPVwibWVzc2FnZVwiXScpO1xuICAgIH1cbiAgICBjb25zdCBtZXNzYWdlID0gdGhpcy5pbnB1dEVsLnZhbHVlO1xuICAgIHRoaXMuaW5wdXRFbC52YWx1ZSA9ICcnO1xuICAgIHJldHVybiBtZXNzYWdlO1xuICB9XG5cbiAgLyoqXG4gICAqIEtleURvd24gZXZlbnQgaGFuZGxlclxuICAgKiBAcGFyYW0ge0V2ZW50fSBldmVudFxuICAgKi9cbiAgbWVzc2FnZVN1Ym1pdChldmVudCkge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgY29uc3QgbWVzc2FnZSA9IHRoaXMuZ2V0TWVzc2FnZSgpO1xuICAgIGlmICghbWVzc2FnZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBvblN1Ym1pdEV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KCdtZXNzYWdlU3VibWl0JywgeyBkZXRhaWw6IHsgbWVzc2FnZSB9IH0pO1xuICAgIHRoaXMuZWwuZGlzcGF0Y2hFdmVudChvblN1Ym1pdEV2ZW50KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBNZXNzYWdlIHN1Ym1pdCBoYW5kbGVyXG4gICAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50XG4gICAqL1xuICBrZXlEb3duKGV2ZW50KSB7XG4gICAgaWYgKGV2ZW50LndoaWNoICE9PSAxMyB8fCBldmVudC5hbHRLZXkgfHwgZXZlbnQuY3RybEtleSB8fCBldmVudC5zaGlmdEtleSB8fCBldmVudC5tZXRhS2V5KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgdGhpcy5tZXNzYWdlU3VibWl0KGV2ZW50KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW5kZXIgdGhlIG1lc3NhZ2UgZm9ybSBibG9jay5cbiAgICovXG4gIHJlbmRlcigpIHtcbiAgICB0aGlzLmVsLmlubmVySFRNTCA9IGZvcm1UZW1wbGF0ZSgpO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IE1lc3NhZ2VGb3JtO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vY29tcG9uZW50cy9tZXNzYWdlRm9ybS9tZXNzYWdlRm9ybS5qcyIsImltcG9ydCBzdHlsZXMgZnJvbSAnLi91c2VyLmNzcyc7XG5pbXBvcnQgdXNlclRlbXBsYXRlIGZyb20gJy4vdXNlci50bXBsLnB1Zyc7XG5cbmNvbnN0IEFOT05JTU9VU19VU0VSTkFNRSA9ICfQkNC90L7QvdC40LwnO1xuY29uc3QgREVGQVVMVF9BVkFUQVIgPSAnLi9jb21wb25lbnRzL3VzZXIvbm9BdmF0YXIuanBnJztcblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBVc2VyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gdXNlcklkXG4gKiBAcHJvcGVydHkge3N0cmluZ30gdXNlcm5hbWVcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBhdmF0YXJVcmxcbiAqL1xuXG5jbGFzcyBVc2VyIHtcblxuICBjb25zdHJ1Y3Rvcih7IGVsLCBTdG9yYWdlIH0pIHtcbiAgICB0aGlzLmVsID0gZWw7XG4gICAgdGhpcy5zdG9yYWdlID0gbmV3IFN0b3JhZ2UoKTtcbiAgICB0aGlzLmluaXRFdmVudHMoKTtcbiAgICB0aGlzLmRhdGEgPSB7XG4gICAgICB1c2VySWQ6IHRoaXMuc3RvcmFnZS5nZXRJdGVtKCd1c2VySWQnKSB8fCBgYW5vbmltb3VzLSR7KE1hdGgucmFuZG9tKCkgKiAxMDAwMDAwMDAwKS50b0ZpeGVkKCl9YCxcbiAgICAgIHVzZXJuYW1lOiB0aGlzLnN0b3JhZ2UuZ2V0SXRlbSgndXNlcm5hbWUnKSxcbiAgICAgIGF2YXRhclVybDogdGhpcy5zdG9yYWdlLmdldEl0ZW0oJ2F2YXRhclVybCcpLFxuICAgIH07XG4gICAgdGhpcy5zYXZlVXNlclRvU3RvcmFnZSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEluaXQgdGhlIHVzZXIgZXZlbnRzLlxuICAgKi9cbiAgaW5pdEV2ZW50cygpIHtcbiAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5jbGljay5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHRoaXMuc3VibWl0LmJpbmQodGhpcykpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgdXNlciBJRC5cbiAgICogQHJldHVybnMge3N0cmluZ31cbiAgICovXG4gIGdldCB1c2VySWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuZGF0YS51c2VySWQ7XG4gIH1cblxuICAvKipcbiAgICogU2V0IHRoZSB1c2VyIElEIGJ5IGEgdXNlcm5hbWUuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB1c2VybmFtZVxuICAgKi9cbiAgc2V0IHVzZXJJZCh1c2VybmFtZSkge1xuICAgIGlmICh1c2VybmFtZSkge1xuICAgICAgdGhpcy5kYXRhLnVzZXJJZCA9IHVzZXJuYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgdXNlcm5hbWUuXG4gICAqIEByZXR1cm5zIHtzdHJpbmd9XG4gICAqL1xuICBnZXQgdXNlcm5hbWUoKSB7XG4gICAgcmV0dXJuIHRoaXMuZGF0YS51c2VybmFtZSB8fCBBTk9OSU1PVVNfVVNFUk5BTUU7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGRlZmF1bHQgdXNlcm5hbWUuXG4gICAqIEByZXR1cm5zIHtzdHJpbmd9XG4gICAqL1xuICBnZXQgZGVmYXVsdFVzZXJuYW1lKCkge1xuICAgIHJldHVybiBBTk9OSU1PVVNfVVNFUk5BTUU7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHRoZSB1c2VyIGF2YXRhciBVUkwuXG4gICAqIEByZXR1cm5zIHtzdHJpbmd9XG4gICAqL1xuICBnZXQgYXZhdGFyVXJsKCkge1xuICAgIHJldHVybiB0aGlzLmRhdGEuYXZhdGFyVXJsIHx8IERFRkFVTFRfQVZBVEFSO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBkZWZhdWx0IGF2YXRhciBVUkwuXG4gICAqIEByZXR1cm5zIHtzdHJpbmd9XG4gICAqL1xuICBnZXQgZGVmYXVsdEF2YXRhclVybCgpIHtcbiAgICByZXR1cm4gREVGQVVMVF9BVkFUQVI7XG4gIH1cblxuICAvKipcbiAgICogU2V0IGN1cnJlbnQgdXNlciBzZXR0aW5ncyB0byBzdG9yYWdlLlxuICAgKi9cbiAgc2F2ZVVzZXJUb1N0b3JhZ2UoKSB7XG4gICAgdGhpcy5zdG9yYWdlLnNldEl0ZW0oJ3VzZXJJZCcsIHRoaXMuZGF0YS51c2VySWQpO1xuICAgIGlmICh0aGlzLmRhdGEudXNlcm5hbWUpIHtcbiAgICAgIHRoaXMuc3RvcmFnZS5zZXRJdGVtKCd1c2VybmFtZScsIHRoaXMuZGF0YS51c2VybmFtZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc3RvcmFnZS5yZW1vdmVJdGVtKCd1c2VybmFtZScpO1xuICAgIH1cbiAgICBpZiAodGhpcy5kYXRhLmF2YXRhclVybCkge1xuICAgICAgdGhpcy5zdG9yYWdlLnNldEl0ZW0oJ2F2YXRhclVybCcsIHRoaXMuZGF0YS5hdmF0YXJVcmwpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnN0b3JhZ2UucmVtb3ZlSXRlbSgnYXZhdGFyVXJsJyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFN1Ym1pdCBldmVudCBoYW5kbGVyLlxuICAgKiBAcGFyYW0ge0V2ZW50fSBldmVudFxuICAgKi9cbiAgc3VibWl0KGV2ZW50KSB7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICBpZiAoXG4gICAgICBldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCd1c2VyLWZvcm0nKSAmJlxuICAgICAgZXZlbnQudGFyZ2V0LmRhdGFzZXQuYWN0aW9uICYmXG4gICAgICB0aGlzW2V2ZW50LnRhcmdldC5kYXRhc2V0LmFjdGlvbl1cbiAgICApIHtcbiAgICAgIHRoaXNbZXZlbnQudGFyZ2V0LmRhdGFzZXQuYWN0aW9uXShldmVudCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENsaWNrIGV2ZW50IGhhbmRsZXIuXG4gICAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50XG4gICAqL1xuICBjbGljayhldmVudCkge1xuICAgIGlmIChldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCd0b2dnbGUnKSAmJiBldmVudC50YXJnZXQuZGF0YXNldC50b2dnbGUpIHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoJ1tuYW1lPXVzZXJuYW1lXScpLnZhbHVlID0gdGhpcy51c2VybmFtZTtcbiAgICAgIHRoaXMuZWwucXVlcnlTZWxlY3RvcignW25hbWU9YXZhdGFyVXJsXScpLnZhbHVlID0gdGhpcy5kYXRhLmF2YXRhclVybCB8fCAnJztcbiAgICAgIHRoaXMuZWwucXVlcnlTZWxlY3RvcihgLnVzZXIgLnVzZXItZm9ybV9fJHtldmVudC50YXJnZXQuZGF0YXNldC50b2dnbGV9YCkuY2xhc3NMaXN0LnRvZ2dsZSgnaGlkZGVuJyk7XG4gICAgICBpZiAoZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygndG9nZ2xlZCcpKSB7XG4gICAgICAgIGV2ZW50LnRhcmdldC5oaWRkZW4gPSB0cnVlO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBTZXQgdXNlciBhdmF0YXIuXG4gICAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50XG4gICAqL1xuICBzZXRBdmF0YXIoZXZlbnQpIHtcbiAgICBjb25zdCBlbCA9IGV2ZW50LnRhcmdldC5xdWVyeVNlbGVjdG9yKCdbbmFtZT1hdmF0YXJVcmxdJyk7XG4vLyAgICAgIGlmIChlbCAmJiBlbC52YWx1ZSAmJiBlbC52YWx1ZS5tYXRjaCgvLihqcGd8anBlZ3xwbmd8Z2lmKSQvaSkpIHtcbiAgICBpZiAoZWwgJiYgZWwudmFsdWUpIHtcbiAgICAgIHRoaXMuZGF0YS5hdmF0YXJVcmwgPSBlbC52YWx1ZTtcbiAgICB9XG4gICAgdGhpcy5zYXZlVXNlclRvU3RvcmFnZSgpO1xuICAgIHRoaXMucmVuZGVyKCk7XG4gIH1cblxuICAvKipcbiAgICogU2V0IHVzZXJuYW1lLlxuICAgKiBAcGFyYW0ge0V2ZW50fSBldmVudFxuICAgKi9cbiAgc2V0VXNlcm5hbWUoZXZlbnQpIHtcbiAgICBjb25zdCBlbCA9IGV2ZW50LnRhcmdldC5xdWVyeVNlbGVjdG9yKCdbbmFtZT11c2VybmFtZV0nKTtcbiAgICBpZiAoZWwgJiYgZWwudmFsdWUpIHtcbiAgICAgIHRoaXMuZGF0YS51c2VybmFtZSA9IGVsLnZhbHVlO1xuICAgICAgdGhpcy51c2VySWQgPSBlbC52YWx1ZTtcbiAgICB9XG4gICAgdGhpcy5zYXZlVXNlclRvU3RvcmFnZSgpO1xuICAgIHRoaXMucmVuZGVyKCk7XG4gIH1cblxuICAvKipcbiAgICogUmVuZGVyIHRoZSB1c2VyIGRhdGEgYmxvY2suXG4gICAqL1xuICByZW5kZXIoKSB7XG4gICAgdGhpcy5lbC5pbm5lckhUTUwgPSB1c2VyVGVtcGxhdGUodGhpcyk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgVXNlcjtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL2NvbXBvbmVudHMvdXNlci91c2VyLmpzIiwiY2xhc3MgSHR0cFJlcXVlc3Qge1xuXG4gIGNvbnN0cnVjdG9yKHNlcnZlclVybCkge1xuICAgIHRoaXMuc2VydmVyVXJsID0gc2VydmVyVXJsO1xuICB9XG5cbiAgc2VuZFJlcXVlc3Qoe3R5cGUgPSAnR0VUJywgcGF0aCwgZGF0YSA9IHt9fSkge1xuICAgIGNvbnN0IHJlcXVlc3QgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICByZXF1ZXN0Lm9wZW4odHlwZSwgYCR7dGhpcy5zZXJ2ZXJVcmx9LyR7cGF0aH1gLCB0cnVlKTtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgKCkgPT4ge1xuICAgICAgICByZXNvbHZlKEpTT04ucGFyc2UocmVxdWVzdC5yZXNwb25zZVRleHQpKTtcbiAgICAgIH0pO1xuICAgICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsIChldmVudCkgPT4ge1xuICAgICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcihldmVudC50YXJnZXQuc3RhdHVzVGV4dCk7XG4gICAgICAgIGVycm9yLmNvZGUgPSBldmVudC50YXJnZXQuc3RhdHVzO1xuICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgfSk7XG4gICAgICByZXF1ZXN0LnNlbmQoSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBhbGwgbWVzc2FnZXMuXG4gICAqL1xuICBnZXRBbGxNZXNzYWdlcygpIHtcbiAgICByZXR1cm4gdGhpcy5zZW5kUmVxdWVzdCh7XG4gICAgICBwYXRoOiAnbWVzc2FnZXMuanNvbicsXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHRoZSBtZXNzYWdlIGJ5IG1lc3NhZ2VJZC5cbiAgICogQHBhcmFtIHtzdHJpbmd9IG1lc3NhZ2VJZFxuICAgKi9cbiAgZ2V0TWVzc2FnZShtZXNzYWdlSWQpIHtcbiAgICByZXR1cm4gdGhpcy5zZW5kUmVxdWVzdCh7XG4gICAgICBwYXRoOiBgbWVzc2FnZXMvJHttZXNzYWdlSWR9Lmpzb25gLFxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSB0aGUgbWVzc2FnZSBieSBtZXNzYWdlSWQuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlSWRcbiAgICogQHBhcmFtIHtDaGF0TWVzc2FnZX0gbWVzc2FnZVxuICAgKiBAcmV0dXJucyB7UHJvbWlzZX1cbiAgICovXG4gIG1lc3NhZ2VVcGRhdGUobWVzc2FnZUlkLCBtZXNzYWdlKSB7XG4gICAgcmV0dXJuIHRoaXMuc2VuZFJlcXVlc3Qoe1xuICAgICAgdHlwZTogJ1BVVCcsXG4gICAgICBwYXRoOiBgbWVzc2FnZXMvJHttZXNzYWdlSWR9Lmpzb25gLFxuICAgICAgZGF0YTogbWVzc2FnZSxcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZW5kIGEgbmV3IG1lc3NhZ2UuXG4gICAqIEBwYXJhbSB7Q2hhdE1lc3NhZ2V9IG1lc3NhZ2VcbiAgICogQHJldHVybnMge1Byb21pc2V9XG4gICAqL1xuICBtZXNzYWdlQWRkKG1lc3NhZ2UpIHtcbiAgICByZXR1cm4gdGhpcy5zZW5kUmVxdWVzdCh7XG4gICAgICB0eXBlOiAnUE9TVCcsXG4gICAgICBwYXRoOiAnbWVzc2FnZXMuanNvbicsXG4gICAgICBkYXRhOiBtZXNzYWdlLFxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIERlbGV0ZSB0aGUgbWVzc2FnZSBieSBtZXNzYWdlSWQuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlSWRcbiAgICogQHJldHVybnMge1Byb21pc2V9XG4gICAqL1xuICBtZXNzYWdlRGVsZXRlKG1lc3NhZ2VJZCkge1xuICAgIHJldHVybiB0aGlzLnNlbmRSZXF1ZXN0KHtcbiAgICAgIHR5cGU6ICdERUxFVEUnLFxuICAgICAgcGF0aDogYG1lc3NhZ2VzLyR7bWVzc2FnZUlkfS5qc29uYCxcbiAgICB9KTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBIdHRwUmVxdWVzdDtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL21vZHVsZXMvaHR0cFJlcXVlc3QuanMiLCJjbGFzcyBTdG9yYWdlIHtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLnN0b3JhZ2UgPSB3aW5kb3cubG9jYWxTdG9yYWdlO1xuICB9XG5cbiAgZ2V0SXRlbShrZXkpIHtcbiAgICByZXR1cm4gdGhpcy5zdG9yYWdlLmdldEl0ZW0oa2V5KTtcbiAgfVxuXG4gIHNldEl0ZW0oa2V5LCB2YWx1ZSkge1xuICAgIHJldHVybiB0aGlzLnN0b3JhZ2Uuc2V0SXRlbShrZXksIHZhbHVlKTtcbiAgfVxuXG4gIHJlbW92ZUl0ZW0oa2V5KSB7XG4gICAgcmV0dXJuIHRoaXMuc3RvcmFnZS5yZW1vdmVJdGVtKGtleSk7XG4gIH1cblxuICBjbGVhcigpIHtcbiAgICByZXR1cm4gdGhpcy5zdG9yYWdlLmNsZWFyKCk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgU3RvcmFnZTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL21vZHVsZXMvc3RvcmFnZS5qcyIsImltcG9ydCBzdHlsZXMgZnJvbSAnLi9hcHAuY3NzJztcbmltcG9ydCBTdG9yYWdlIGZyb20gJy4uLy4uL21vZHVsZXMvc3RvcmFnZSc7XG5pbXBvcnQgSHR0cFJlcXVlc3QgZnJvbSAnLi4vLi4vbW9kdWxlcy9odHRwUmVxdWVzdCc7XG5pbXBvcnQgQ2hhdCBmcm9tICcuLi9jaGF0L2NoYXQnO1xuaW1wb3J0IFVzZXIgZnJvbSAnLi4vdXNlci91c2VyJztcbmltcG9ydCBNZXNzYWdlRm9ybSBmcm9tICcuLi9tZXNzYWdlRm9ybS9tZXNzYWdlRm9ybSc7XG5cbmNvbnN0IHNlcnZlclJlcXVlc3QgPSBuZXcgSHR0cFJlcXVlc3QoJ2h0dHBzOi8vbWV2bGNoYXQuZmlyZWJhc2Vpby5jb20nKTtcbmNvbnN0IFVQREFURV9NRVNTQUdFU19JTlRFUlZBTCA9IDMwMDA7XG5cbmNsYXNzIEFwcCB7XG5cbiAgY29uc3RydWN0b3IoeyB1c2VyRWwsIG1lc3NhZ2VGb3JtRWwsIGNoYXRFbCB9KSB7XG4gICAgdGhpcy51c2VyID0gbmV3IFVzZXIoeyBlbDogdXNlckVsLCBTdG9yYWdlIH0pO1xuICAgIHRoaXMuY2hhdCA9IG5ldyBDaGF0KHsgZWw6IGNoYXRFbCwgY3VycmVudFVzZXI6IHRoaXMudXNlciB9KTtcbiAgICB0aGlzLm1lc3NhZ2VGb3JtID0gbmV3IE1lc3NhZ2VGb3JtKHsgZWw6IG1lc3NhZ2VGb3JtRWwgfSk7XG4gICAgdGhpcy5pbml0RXZlbnRzKCk7XG4gIH1cblxuICAvKipcbiAgICogSW5pdCB0aGUgYXBwbGljYXRpb24gZXZlbnRzLlxuICAgKi9cbiAgaW5pdEV2ZW50cygpIHtcbiAgICB0aGlzLm1lc3NhZ2VGb3JtLm9uKCdtZXNzYWdlU3VibWl0JywgdGhpcy5tZXNzYWdlU3VibWl0LmJpbmQodGhpcykpO1xuICAgIHRoaXMuY2hhdC5vbignbWVzc2FnZURlbGV0ZScsIHRoaXMuZGVsZXRlTWVzc2FnZS5iaW5kKHRoaXMpKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCd2aXNpYmlsaXR5Y2hhbmdlJywgKCkgPT4ge1xuICAgICAgaWYgKGRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSA9PT0gJ2hpZGRlbicpIHtcbiAgICAgICAgdGhpcy5zdG9wSW50ZXJ2YWxVcGRhdGUoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuc3RhcnRJbnRlcnZhbFVwZGF0ZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFN0YXJ0IHBlcmlvZGljYWxseSBtZXNzYWdlcyB1cGRhdGluZy5cbiAgICogQHBhcmFtIHtudW1iZXJ9IGludGVydmFsXG4gICAqL1xuICBzdGFydEludGVydmFsVXBkYXRlKGludGVydmFsID0gVVBEQVRFX01FU1NBR0VTX0lOVEVSVkFMKSB7XG4gICAgdGhpcy5pbnRlcnZhbFVwZGF0ZShpbnRlcnZhbCk7XG4gIH1cblxuICAvKipcbiAgICogU3RhcnQgcGVyaW9kaWNhbGx5IG1lc3NhZ2VzIHVwZGF0aW5nLlxuICAgKi9cbiAgc3RvcEludGVydmFsVXBkYXRlKCkge1xuICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVySWQpO1xuICB9XG5cbiAgLyoqXG4gICAqIFBlcmlvZGljYWxseSBtZXNzYWdlcyB1cGRhdGluZy5cbiAgICogQHBhcmFtIHtudW1iZXJ9IGludGVydmFsXG4gICAqL1xuICBpbnRlcnZhbFVwZGF0ZShpbnRlcnZhbCkge1xuICAgIHRoaXMudXBkYXRlTWVzc2FnZXMoKTtcbiAgICB0aGlzLnRpbWVySWQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHRoaXMuaW50ZXJ2YWxVcGRhdGUuY2FsbCh0aGlzLCBpbnRlcnZhbCk7XG4gICAgfSwgaW50ZXJ2YWwpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBhY3R1YWwgbWVzc2FnZXMgZnJvbSB0aGUgc2VyYmVyIGFuZCB1cGRhdGUgbWVzc2FnZXMgbGlzdC5cbiAgICovXG4gIHVwZGF0ZU1lc3NhZ2VzKCkge1xuICAgIHNlcnZlclJlcXVlc3RcbiAgICAgIC5nZXRBbGxNZXNzYWdlcygpXG4gICAgICAudGhlbigocmVzcG9uc2UpID0+IHtcbiAgICAgICAgdGhpcy5jaGF0LnVwZGF0ZU1lc3NhZ2VzKHJlc3BvbnNlKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgIC8vIFRPRE86INCe0LHRgNCw0LHQvtGC0LDRgtGMINC+0YjQuNCx0LrRg1xuICAgICAgICBjb25zb2xlLmxvZygnRXJyb3InLCBlcnJvcik7XG4gICAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxsYmFjayBmb3IgbWVzc2FnZSBzdWJtaXQuIExpbmsgTWVzc2FnZUZvcm0gYW5kIENoYXQgY29tcG9uZW50cy5cbiAgICogQHBhcmFtIHtFdmVudH0gZXZlbnRcbiAgICovXG4gIG1lc3NhZ2VTdWJtaXQoZXZlbnQpIHtcbiAgICBjb25zdCBtZXNzYWdlID0ge1xuICAgICAgdXNlcklkOiB0aGlzLnVzZXIudXNlcklkLFxuICAgICAgdXNlcm5hbWU6IHRoaXMudXNlci5kYXRhLnVzZXJuYW1lLFxuICAgICAgYXZhdGFyVXJsOiB0aGlzLnVzZXIuZGF0YS5hdmF0YXJVcmwsXG4gICAgICBkYXRlOiBuZXcgRGF0ZSgpLmdldFRpbWUoKSxcbiAgICAgIG1lc3NhZ2U6IGV2ZW50LmRldGFpbC5tZXNzYWdlLFxuICAgIH07XG4gICAgc2VydmVyUmVxdWVzdFxuICAgICAgLm1lc3NhZ2VBZGQobWVzc2FnZSlcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgdGhpcy51cGRhdGVNZXNzYWdlcygpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgLy8gVE9ETzog0J7QsdGA0LDQsdC+0YLQsNGC0Ywg0L7RiNC40LHQutGDXG4gICAgICAgIGNvbnNvbGUubG9nKCdFcnJvcicsIGVycm9yKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGxiYWNrIGZvciBtZXNzYWdlIGRlbGV0ZS5cbiAgICogQHBhcmFtIHtFdmVudH0gZXZlbnRcbiAgICovXG4gIGRlbGV0ZU1lc3NhZ2UoZXZlbnQpIHtcbiAgICBjb25zdCBtZXNzYWdlSWQgPSBldmVudC5kZXRhaWwubWVzc2FnZUlkO1xuICAgIHNlcnZlclJlcXVlc3RcbiAgICAgIC5tZXNzYWdlRGVsZXRlKG1lc3NhZ2VJZClcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgdGhpcy5jaGF0LmRlbGV0ZU1lc3NhZ2UobWVzc2FnZUlkKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgIC8vIFRPRE86INCe0LHRgNCw0LHQvtGC0LDRgtGMINC+0YjQuNCx0LrRg1xuICAgICAgICBjb25zb2xlLmxvZygnRXJyb3InLCBlcnJvcik7XG4gICAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW5kZXIgdGhlIGFwcGxpY2F0aW9uLlxuICAgKi9cbiAgcmVuZGVyKCkge1xuICAgIHRoaXMudXNlci5yZW5kZXIoKTtcbiAgICB0aGlzLm1lc3NhZ2VGb3JtLnJlbmRlcigpO1xuICAgIHRoaXMuc3RhcnRJbnRlcnZhbFVwZGF0ZSgpO1xuICB9XG59XG5cbndpbmRvdy5BcHAgPSBBcHA7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9jb21wb25lbnRzL2FwcC9hcHAuanMiLCJ2YXIgcHVnID0gcmVxdWlyZShcIiEuLi8uLi9ub2RlX21vZHVsZXMvcHVnLXJ1bnRpbWUvaW5kZXguanNcIik7XG5cbmZ1bmN0aW9uIHRlbXBsYXRlKGxvY2Fscykge3ZhciBwdWdfaHRtbCA9IFwiXCIsIHB1Z19taXhpbnMgPSB7fSwgcHVnX2ludGVycDs7dmFyIGxvY2Fsc19mb3Jfd2l0aCA9IChsb2NhbHMgfHwge30pOyhmdW5jdGlvbiAoYXZhdGFyVXJsLCBkYXRlLCBpZCwgaXNPd24sIHRleHQsIHVzZXJuYW1lKSB7cHVnX2h0bWwgPSBwdWdfaHRtbCArIFwiXFx1MDAzQ2xpXCIgKyAocHVnLmF0dHIoXCJjbGFzc1wiLCBwdWcuY2xhc3NlcyhbXCJjaGF0X19tZXNzYWdlXCIsaXNPd24gPyAnY2hhdF9fbWVzc2FnZV9vd24nIDogJyddLCBbZmFsc2UsdHJ1ZV0pLCBmYWxzZSwgdHJ1ZSkrcHVnLmF0dHIoXCJpZFwiLCBpZCwgdHJ1ZSwgdHJ1ZSkpICsgXCJcXHUwMDNFXFx1MDAzQ2RpdiBjbGFzcz1cXFwiY2hhdF9fbWVzc2FnZV9hdmF0YXJcXFwiXFx1MDAzRVxcdTAwM0NpbWdcIiArIChwdWcuYXR0cihcInNyY1wiLCBhdmF0YXJVcmwsIHRydWUsIHRydWUpK3B1Zy5hdHRyKFwiYWx0XCIsIHVzZXJuYW1lLCB0cnVlLCB0cnVlKSkgKyBcIlxcdTAwM0VcXHUwMDNDXFx1MDAyRmRpdlxcdTAwM0VcXHUwMDNDZGl2IGNsYXNzPVxcXCJjaGF0X19tZXNzYWdlX2hlYWRlclxcXCJcXHUwMDNFXFx1MDAzQ3NwYW4gY2xhc3M9XFxcImNoYXRfX21lc3NhZ2VfYXV0aG9yXFxcIlxcdTAwM0VcIiArIChwdWcuZXNjYXBlKG51bGwgPT0gKHB1Z19pbnRlcnAgPSB1c2VybmFtZSkgPyBcIlwiIDogcHVnX2ludGVycCkpICsgXCJcXHUwMDNDXFx1MDAyRnNwYW5cXHUwMDNFXFx1MDAzQ2lucHV0IGNsYXNzPVxcXCJjaGF0X19tZXNzYWdlX2J1dHRvblxcXCIgdHlwZT1cXFwiYnV0dG9uXFxcIiB2YWx1ZT1cXFwieFxcXCJcXHUwMDNFXFx1MDAzQ3NwYW4gY2xhc3M9XFxcImNoYXRfX21lc3NhZ2VfZGF0ZVxcXCJcXHUwMDNFXCIgKyAocHVnLmVzY2FwZShudWxsID09IChwdWdfaW50ZXJwID0gZGF0ZS50b0xvY2FsZVN0cmluZygncnUnLCB7IGhvdXI6ICcyLWRpZ2l0JywgbWludXRlOiAnMi1kaWdpdCcgfSkpID8gXCJcIiA6IHB1Z19pbnRlcnApKSArIFwiXFx1MDAzQ1xcdTAwMkZzcGFuXFx1MDAzRVxcdTAwM0NcXHUwMDJGZGl2XFx1MDAzRVxcdTAwM0NkaXYgY2xhc3M9XFxcImNoYXRfX21lc3NhZ2VfdGV4dFxcXCJcXHUwMDNFXCIgKyAocHVnLmVzY2FwZShudWxsID09IChwdWdfaW50ZXJwID0gdGV4dCkgPyBcIlwiIDogcHVnX2ludGVycCkpICsgXCJcXHUwMDNDXFx1MDAyRmRpdlxcdTAwM0VcXHUwMDNDXFx1MDAyRmxpXFx1MDAzRVwiO30uY2FsbCh0aGlzLFwiYXZhdGFyVXJsXCIgaW4gbG9jYWxzX2Zvcl93aXRoP2xvY2Fsc19mb3Jfd2l0aC5hdmF0YXJVcmw6dHlwZW9mIGF2YXRhclVybCE9PVwidW5kZWZpbmVkXCI/YXZhdGFyVXJsOnVuZGVmaW5lZCxcImRhdGVcIiBpbiBsb2NhbHNfZm9yX3dpdGg/bG9jYWxzX2Zvcl93aXRoLmRhdGU6dHlwZW9mIGRhdGUhPT1cInVuZGVmaW5lZFwiP2RhdGU6dW5kZWZpbmVkLFwiaWRcIiBpbiBsb2NhbHNfZm9yX3dpdGg/bG9jYWxzX2Zvcl93aXRoLmlkOnR5cGVvZiBpZCE9PVwidW5kZWZpbmVkXCI/aWQ6dW5kZWZpbmVkLFwiaXNPd25cIiBpbiBsb2NhbHNfZm9yX3dpdGg/bG9jYWxzX2Zvcl93aXRoLmlzT3duOnR5cGVvZiBpc093biE9PVwidW5kZWZpbmVkXCI/aXNPd246dW5kZWZpbmVkLFwidGV4dFwiIGluIGxvY2Fsc19mb3Jfd2l0aD9sb2NhbHNfZm9yX3dpdGgudGV4dDp0eXBlb2YgdGV4dCE9PVwidW5kZWZpbmVkXCI/dGV4dDp1bmRlZmluZWQsXCJ1c2VybmFtZVwiIGluIGxvY2Fsc19mb3Jfd2l0aD9sb2NhbHNfZm9yX3dpdGgudXNlcm5hbWU6dHlwZW9mIHVzZXJuYW1lIT09XCJ1bmRlZmluZWRcIj91c2VybmFtZTp1bmRlZmluZWQpKTs7cmV0dXJuIHB1Z19odG1sO307XG5tb2R1bGUuZXhwb3J0cyA9IHRlbXBsYXRlO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vY29tcG9uZW50cy9jaGF0L21lc3NhZ2UudG1wbC5wdWdcbi8vIG1vZHVsZSBpZCA9IDExXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsInZhciBwdWcgPSByZXF1aXJlKFwiIS4uLy4uL25vZGVfbW9kdWxlcy9wdWctcnVudGltZS9pbmRleC5qc1wiKTtcblxuZnVuY3Rpb24gdGVtcGxhdGUobG9jYWxzKSB7dmFyIHB1Z19odG1sID0gXCJcIiwgcHVnX21peGlucyA9IHt9LCBwdWdfaW50ZXJwO3B1Z19odG1sID0gcHVnX2h0bWwgKyBcIlxcdTAwM0Nmb3JtIGNsYXNzPVxcXCJtZXNzYWdlLWZvcm1cXFwiXFx1MDAzRVxcdTAwM0N0ZXh0YXJlYSBjbGFzcz1cXFwibWVzc2FnZS1mb3JtX19pbnB1dFxcXCIgbmFtZT1cXFwibWVzc2FnZVxcXCIgcGxhY2Vob2xkZXI9XFxcItCh0L7QvtCx0YnQtdC90LjQtS4uLlxcXCJcXHUwMDNFXFx1MDAzQ1xcdTAwMkZ0ZXh0YXJlYVxcdTAwM0VcXHUwMDNDaW5wdXQgY2xhc3M9XFxcImJ1dHRvbiBtZXNzYWdlLWZvcm1fX2J1dHRvbiBpbnB1dF9idXR0b25cXFwiIHR5cGU9XFxcInN1Ym1pdFxcXCIgdmFsdWU9XFxcIiZndDtcXFwiXFx1MDAzRVxcdTAwM0NcXHUwMDJGZm9ybVxcdTAwM0VcIjs7cmV0dXJuIHB1Z19odG1sO307XG5tb2R1bGUuZXhwb3J0cyA9IHRlbXBsYXRlO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vY29tcG9uZW50cy9tZXNzYWdlRm9ybS9mb3JtLnRtcGwucHVnXG4vLyBtb2R1bGUgaWQgPSAxMlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJ2YXIgcHVnID0gcmVxdWlyZShcIiEuLi8uLi9ub2RlX21vZHVsZXMvcHVnLXJ1bnRpbWUvaW5kZXguanNcIik7XG5cbmZ1bmN0aW9uIHRlbXBsYXRlKGxvY2Fscykge3ZhciBwdWdfaHRtbCA9IFwiXCIsIHB1Z19taXhpbnMgPSB7fSwgcHVnX2ludGVycDs7dmFyIGxvY2Fsc19mb3Jfd2l0aCA9IChsb2NhbHMgfHwge30pOyhmdW5jdGlvbiAoYXZhdGFyVXJsLCB1c2VybmFtZSkge3B1Z19odG1sID0gcHVnX2h0bWwgKyBcIlxcdTAwM0NkaXYgY2xhc3M9XFxcInVzZXJcXFwiXFx1MDAzRVxcdTAwM0NoMSBjbGFzcz1cXFwidXNlcl9fdXNlcm5hbWUgdG9nZ2xlIHRvZ2dsZWRcXFwiIGRhdGEtdG9nZ2xlPVxcXCJ1c2VybmFtZVxcXCJcXHUwMDNFXCIgKyAocHVnLmVzY2FwZShudWxsID09IChwdWdfaW50ZXJwID0gdXNlcm5hbWUpID8gXCJcIiA6IHB1Z19pbnRlcnApKSArIFwiXFx1MDAzQ1xcdTAwMkZoMVxcdTAwM0VcXHUwMDNDZm9ybSBjbGFzcz1cXFwidXNlci1mb3JtIHVzZXItZm9ybV9fdXNlcm5hbWUgaGlkZGVuXFxcIiBkYXRhLWFjdGlvbj1cXFwic2V0VXNlcm5hbWVcXFwiXFx1MDAzRVxcdTAwM0NpbnB1dCBjbGFzcz1cXFwidXNlcl9faW5wdXQgdXNlcl9faW5wdXRfdXNlcm5hbWVcXFwiIG5hbWU9XFxcInVzZXJuYW1lXFxcIiBwbGFjZWhvbGRlcj1cXFwi0KPQutCw0LbQuNGC0LUg0LjQvNGPXFxcIlxcdTAwM0VcXHUwMDNDaW5wdXQgY2xhc3M9XFxcImJ1dHRvbiB1c2VyX19pbnB1dF9idXR0b24gaW5wdXRfYnV0dG9uXFxcIiB0eXBlPVxcXCJzdWJtaXRcXFwiIHZhbHVlPVxcXCImZ3Q7XFxcIlxcdTAwM0VcXHUwMDNDXFx1MDAyRmZvcm1cXHUwMDNFXFx1MDAzQ2Zvcm0gY2xhc3M9XFxcInVzZXItZm9ybSB1c2VyLWZvcm1fX2F2YXRhciBoaWRkZW5cXFwiIGRhdGEtYWN0aW9uPVxcXCJzZXRBdmF0YXJcXFwiXFx1MDAzRVxcdTAwM0NpbnB1dCBjbGFzcz1cXFwidXNlcl9faW5wdXQgdXNlcl9faW5wdXRfYXZhdGFyXFxcIiBuYW1lPVxcXCJhdmF0YXJVcmxcXFwiIHBsYWNlaG9sZGVyPVxcXCJVUkwg0LDQstCw0YLQsNGA0YtcXFwiXFx1MDAzRVxcdTAwM0NpbnB1dCBjbGFzcz1cXFwiYnV0dG9uIHVzZXJfX2lucHV0X2J1dHRvbiBpbnB1dF9idXR0b25cXFwiIHR5cGU9XFxcInN1Ym1pdFxcXCIgdmFsdWU9XFxcIiZndDtcXFwiXFx1MDAzRVxcdTAwM0NcXHUwMDJGZm9ybVxcdTAwM0VcXHUwMDNDZmlndXJlIGNsYXNzPVxcXCJ1c2VyX19hdmF0YXJcXFwiXFx1MDAzRVxcdTAwM0NpbWdcIiArIChcIiBjbGFzcz1cXFwidG9nZ2xlXFxcIlwiK1wiIGRhdGEtdG9nZ2xlPVxcXCJhdmF0YXJcXFwiXCIrcHVnLmF0dHIoXCJzcmNcIiwgYXZhdGFyVXJsLCB0cnVlLCB0cnVlKStwdWcuYXR0cihcImFsdFwiLCB1c2VybmFtZSwgdHJ1ZSwgdHJ1ZSkpICsgXCJcXHUwMDNFXFx1MDAzQ1xcdTAwMkZmaWd1cmVcXHUwMDNFXFx1MDAzQ1xcdTAwMkZkaXZcXHUwMDNFXCI7fS5jYWxsKHRoaXMsXCJhdmF0YXJVcmxcIiBpbiBsb2NhbHNfZm9yX3dpdGg/bG9jYWxzX2Zvcl93aXRoLmF2YXRhclVybDp0eXBlb2YgYXZhdGFyVXJsIT09XCJ1bmRlZmluZWRcIj9hdmF0YXJVcmw6dW5kZWZpbmVkLFwidXNlcm5hbWVcIiBpbiBsb2NhbHNfZm9yX3dpdGg/bG9jYWxzX2Zvcl93aXRoLnVzZXJuYW1lOnR5cGVvZiB1c2VybmFtZSE9PVwidW5kZWZpbmVkXCI/dXNlcm5hbWU6dW5kZWZpbmVkKSk7O3JldHVybiBwdWdfaHRtbDt9O1xubW9kdWxlLmV4cG9ydHMgPSB0ZW1wbGF0ZTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2NvbXBvbmVudHMvdXNlci91c2VyLnRtcGwucHVnXG4vLyBtb2R1bGUgaWQgPSAxM1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwic291cmNlUm9vdCI6IiJ9